<script>
// Cache-bust: ensure every page URL carries ?v=<version>, and rewrite internal links
(function() {
  function buildVersion() {
    var el = document.querySelector('link#quarto-bootstrap');
    if (el && el.getAttribute('href')) {
      var href = el.getAttribute('href');
      var name = href.split('/').pop();
      return name.slice(-12).replace(/[^a-zA-Z0-9]/g,'');
    }
    return String(Math.floor(Date.now()/1000));
  }
  function withVersionRel(url, v) {
    try {
      var u = new URL(url, window.location.href);
      u.searchParams.set('v', v);
      return u.pathname + u.search + u.hash;
    } catch (e) {
      return (url.indexOf('?') === -1) ? (url + '?v=' + v) : (url + '&v=' + v);
    }
  }
  function withVersionAbs(url, v) {
    var u = new URL(url, window.location.href);
    u.searchParams.set('v', v);
    return u.toString();
  }
  function rewriteInternalLinks(v) {
    var links = document.querySelectorAll('a[href]');
    links.forEach(function(a){
      var href = a.getAttribute('href') || '';
      if (!href || href.startsWith('#')) return;
      if (/^https?:\/\//i.test(href)) return; // external
      a.setAttribute('href', withVersionRel(href, v));
    });
  }
  function ensureUrlHasVersion(v) {
    var params = new URLSearchParams(window.location.search);
    if (!params.has('v')) {
      var target = withVersionAbs(window.location.href, v);
      window.location.replace(target);
    }
  }
  document.addEventListener('DOMContentLoaded', function(){
    var v = buildVersion();
    rewriteInternalLinks(v);
    ensureUrlHasVersion(v);
  });
})();
</script>
