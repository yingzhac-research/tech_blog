---
title: "【第5章】期权定价理论与模型：从直觉到 Black-Scholes"
description: "理解期权为何不能用简单的现金流折现来估值，以及如何通过复制组合和无套利原理推导出期权定价公式。"
author: "Ying"
date: "2025-12-05"
lang: zh
categories: [金融, 投资, 估值]
tags: [Valuation, Damodaran, 期权, Black-Scholes, 二叉树模型, 实物期权]
format:
  html:
    toc: true
    toc-depth: 3
    number-sections: true
    html-math-method: mathjax
---

## 从一个问题开始

在估值的世界里，我们通常遵循一条基本原则：**任何资产的价值等于其预期现金流的现值**。但有一类特殊的资产打破了这条规则。

想象一下：你花 5 美元买了一张"权利"，这张权利允许你在三个月后以 100 美元的价格买入某只股票。如果三个月后股票涨到 120 美元，你赚了 15 美元（120 - 100 - 5）；如果股票跌到 90 美元，你会选择不行使这个权利，最多亏损 5 美元。

这就是**期权（Option）**——一种收益不对称的金融工具。它的价值不能简单地用"预期现金流折现"来计算，因为期权持有者可以选择是否行使权利。

你可能会问：

- 为什么波动性越大，期权越值钱？（这似乎与我们对"风险"的直觉相悖！）
- 如何在没有套利机会的前提下，给期权定一个"公平"的价格？
- 著名的 Black-Scholes 公式是如何推导出来的？它背后的核心逻辑是什么？

本章将深入探讨这些问题，并为后续章节中**实物期权（Real Options）**的应用打下基础。

---

## 期权的基本构造：权利而非义务

### 看涨期权与看跌期权

期权赋予持有者以固定价格（称为**执行价格**或**行权价**，Strike Price）在到期日或到期日前买入或卖出标的资产的**权利**——注意，是权利，不是义务。

::: {.callout-important}
## 期权的两种基本类型

- **看涨期权（Call Option）**：持有者有权在到期日或之前以执行价格**买入**标的资产
- **看跌期权（Put Option）**：持有者有权在到期日或之前以执行价格**卖出**标的资产
:::

让我们用一个具体的例子来理解。

**看涨期权的收益结构**：

假设你买了一份执行价格为 100 美元的看涨期权，支付了 5 美元的期权费。到期时：

- 如果股价 = 120 美元：行权，买入股票，**净收益 = 120 - 100 - 5 = 15 美元**
- 如果股价 = 100 美元：不行权，**净收益 = -5 美元**（仅损失期权费）
- 如果股价 = 80 美元：不行权，**净收益 = -5 美元**

关键观察：**下行风险有限（最多损失期权费），上行潜力无限**。

**看跌期权的收益结构**：

假设你买了一份执行价格为 100 美元的看跌期权，支付了 5 美元的期权费。到期时：

- 如果股价 = 80 美元：行权，以 100 美元卖出，**净收益 = 100 - 80 - 5 = 15 美元**
- 如果股价 = 100 美元：不行权，**净收益 = -5 美元**
- 如果股价 = 120 美元：不行权，**净收益 = -5 美元**

### 美式期权与欧式期权

- **欧式期权（European Option）**：只能在到期日行权
- **美式期权（American Option）**：可以在到期日或之前任何时间行权

美式期权的灵活性使其价值至少等于同等条件的欧式期权。但在大多数情况下，由于期权存在**时间价值**，提前行权并不划算——持有者通常能通过卖出期权获得比提前行权更高的收益。

---

## 决定期权价值的六个因素

期权的价值由六个变量决定。理解这些变量如何影响期权价值，是掌握期权定价的第一步。

### 六大因素及其影响

| 因素 | 对看涨期权价值的影响 | 对看跌期权价值的影响 | 直觉解释 |
|------|----------------------|----------------------|----------|
| 标的资产现价 $S$ ↑ | ↑ 增加 | ↓ 减少 | 看涨期权是买入的权利，资产越贵，买入权利越值钱 |
| 执行价格 $K$ ↑ | ↓ 减少 | ↑ 增加 | 执行价格越高，看涨期权越难盈利 |
| 标的资产波动率 $\sigma$ ↑ | ↑ 增加 | ↑ 增加 | **关键洞察**：波动性对期权是好事！ |
| 到期时间 $t$ ↑ | ↑ 增加 | ↑ 增加 | 时间越长，资产价格大幅变动的可能性越大 |
| 无风险利率 $r$ ↑ | ↑ 增加 | ↓ 减少 | 利率越高，执行价格的现值越低 |
| 标的资产股息 $D$ ↑ | ↓ 减少 | ↑ 增加 | 股息支付会降低股价 |

### 为什么波动性越大，期权越值钱？

这是期权定价中最反直觉的一点。在其他资产估值中，波动性（风险）通常是负面的——我们会要求更高的折现率来补偿风险。但对于期权，情况完全不同。

**直觉解释**：

期权持有者的损失是有限的（最多损失期权费），但收益潜力是无限的。高波动性意味着：

- 资产价格大幅上涨的概率增加 → 看涨期权可能获得巨大收益
- 资产价格大幅下跌的概率也增加 → 但看涨期权的损失仍然有限

这种**收益不对称性**使得波动性成为期权持有者的朋友。

**数学解释**：

考虑一个简单的二元世界：股票当前价格 100 美元，可能涨到 110 或跌到 90。看涨期权（执行价格 100）的期望收益是：

$$
E[\text{收益}] = 0.5 \times (110 - 100) + 0.5 \times 0 = 5
$$

现在假设波动性增加：股票可能涨到 130 或跌到 70。期望收益变成：

$$
E[\text{收益}] = 0.5 \times (130 - 100) + 0.5 \times 0 = 15
$$

虽然下行风险也增加了，但期权持有者不在乎——因为亏损被锁定在期权费。

::: {.callout-note}
## 关于波动性的微妙之处

对于深度实值（Deep In-the-Money）的看涨期权，其行为越来越像标的资产本身。在这种极端情况下，高波动性可能降低标的资产的价值，从而间接降低期权价值。但对于大多数期权，波动性仍然是正面因素。
:::

---

## 二叉树模型：从离散世界理解期权定价

### 核心思想：复制组合

期权定价的核心逻辑是**无套利原则**：如果我们能用标的资产和无风险借贷构建一个组合，使其在任何情况下的收益都与期权完全相同，那么这个组合的成本就是期权的价值。

这个组合被称为**复制组合（Replicating Portfolio）**。

### 单期二叉树模型

假设股票当前价格为 $S$，在一个时期后可能上涨到 $Su$ 或下跌到 $Sd$：

```
         Su (上涨)
        /
       S
        \
         Sd (下跌)
```

对于执行价格为 $K$ 的看涨期权：

- 如果股价上涨到 $Su$：期权价值 $C_u = \max(Su - K, 0)$
- 如果股价下跌到 $Sd$：期权价值 $C_d = \max(Sd - K, 0)$

**构建复制组合**：

我们要找到 $\Delta$ 股股票和 $B$ 美元借款的组合，使得：

- 上涨时：$\Delta \times Su - B(1+r) = C_u$
- 下跌时：$\Delta \times Sd - B(1+r) = C_d$

解这个方程组：

$$
\Delta = \frac{C_u - C_d}{Su - Sd}
$$

这个 $\Delta$ 被称为**期权的 Delta**，表示复制一份期权需要持有多少股票。

### 具体数值例子

让我们用一个完整的例子来演示二叉树定价。

**设定**：

- 当前股价 $S = 50$ 美元
- 上涨因子 $u = 1.4$（股价可能涨到 70）
- 下跌因子 $d = 0.7$（股价可能跌到 35）
- 执行价格 $K = 40$ 美元
- 无风险利率 $r = 11\%$
- 期权期限：2 期

**两期二叉树**：

```
t=0          t=1          t=2
                         100 (=70×1.4)
              70
             /  \
            /    50 (=70×0.7 或 35×1.4)
           /
         50
           \
            \
             35
              \
               25 (=35×0.7)
```

**Step 1：计算终点的期权价值**

- 股价 = 100：$C = \max(100-40, 0) = 60$
- 股价 = 50：$C = \max(50-40, 0) = 10$
- 股价 = 25：$C = \max(25-40, 0) = 0$

**Step 2：从 t=1 节点反向计算**

在 $S = 70$ 节点：

$$
\Delta = \frac{60 - 10}{100 - 50} = 1
$$

复制组合需要买入 1 股股票。借款金额 $B$ 满足上涨时的复制条件：

$$
\Delta \times Su - B(1+r) = C_u \implies 1 \times 100 - B \times 1.11 = 60
$$

解得：

$$
B = \frac{100 - 60}{1.11} = \frac{40}{1.11} = 36.04
$$

因此，期权价值 = 复制组合成本 = $\Delta \times S - B = 1 \times 70 - 36.04 = 33.96$ 美元

在 $S = 35$ 节点：

$$
\Delta = \frac{10 - 0}{50 - 25} = 0.4
$$

期权价值 = $35 \times 0.4 - 9.01 = 4.99$ 美元

**Step 3：计算 t=0 的期权价值**

$$
\Delta = \frac{33.96 - 4.99}{70 - 35} = 0.8278
$$

期权价值 = $50 \times 0.8278 - 21.61 = \$19.42$

::: {.callout-tip}
## 二叉树模型的关键洞察

1. **期权价值不依赖于上涨/下跌的概率**——只要无套利，复制组合的成本就是期权价值
2. **Delta 是动态变化的**——在不同节点，复制组合需要不断调整
3. **期权价值由当前价格决定**，而非预期未来价格（当前价格已经反映了市场预期）
:::

### 从 Black-Scholes 到二叉树：参数转换

在实践中，我们经常需要在 Black-Scholes 和二叉树模型之间切换。如果你已经估计了 Black-Scholes 所需的波动率 $\sigma$，如何转换为二叉树模型的上涨/下跌因子？

**转换公式**：

$$
u = e^{\sigma\sqrt{\Delta t} + (r - \frac{\sigma^2}{2})\Delta t}
$$

$$
d = e^{-\sigma\sqrt{\Delta t} + (r - \frac{\sigma^2}{2})\Delta t}
$$

其中 $\Delta t = T/m$ 是每个时间步长（$T$ 是期权期限，$m$ 是总步数）。

**为什么公式中有 $(r - \sigma^2/2)$ 项？** 这是一个常被忽略的细节。在连续时间中，资产价格服从几何布朗运动：

$$
\frac{dS}{S} = \mu \, dt + \sigma \, dW
$$

由于伊藤引理（Itô's Lemma），$\ln S$ 的漂移项不是 $\mu$，而是 $\mu - \sigma^2/2$。在风险中性世界中，$\mu$ 被无风险利率 $r$ 替代，因此漂移变成 $r - \sigma^2/2$。

**数值示例**：

假设：
- 当前股价 $S = \$30$
- 年化波动率 $\sigma = 40\%$
- 无风险利率 $r = 5\%$
- 期权期限 4 年，每年为一个时间步（$\Delta t = 1$）

计算上涨/下跌因子：

$$
u = e^{0.40\sqrt{1} + (0.05 - 0.40^2/2) \times 1} = e^{0.40 - 0.03} = e^{0.37} = 1.4477
$$

$$
d = e^{-0.40\sqrt{1} + (0.05 - 0.40^2/2) \times 1} = e^{-0.40 - 0.03} = e^{-0.43} = 0.6505
$$

用这些参数构建四年期二叉树：

| 时点 | 价格节点 |
|------|----------|
| $t=0$ | $30.00$ |
| $t=1$ | $43.43$ 或 $19.52$ |
| $t=2$ | $62.88$、$28.25$ 或 $12.70$ |
| $t=3$ | $91.03$、$40.90$、$18.38$ 或 $8.26$ |

::: {.callout-note}
## 二叉树与 Black-Scholes 的收敛

当时间步数 $m \to \infty$ 时，二叉树模型收敛到 Black-Scholes 模型。实践中，50-100 步通常足够准确。步数越多，计算量越大，但对美式期权的早期行权处理越精确。
:::

---

## Black-Scholes 模型：连续世界的期权定价

### 从二叉树到连续

当我们把二叉树模型的时间间隔无限细分，价格变化变得连续时，二叉树模型就收敛到著名的 **Black-Scholes 模型**。

1973 年，Fischer Black 和 Myron Scholes 发表了开创性论文，为欧式期权提供了一个封闭解。这个模型为 Scholes 赢得了 1997 年诺贝尔经济学奖（Black 已于 1995 年去世）。

### Black-Scholes 公式

**看涨期权价值**：

$$
C = S \cdot N(d_1) - K e^{-rt} \cdot N(d_2)
$$

其中：

$$
d_1 = \frac{\ln(S/K) + (r + \sigma^2/2)t}{\sigma\sqrt{t}}
$$

$$
d_2 = d_1 - \sigma\sqrt{t}
$$

**变量含义**：

- $S$：标的资产当前价格
- $K$：执行价格
- $t$：到期时间（年）
- $r$：无风险利率（连续复利）
- $\sigma$：标的资产价格对数的年化标准差
- $N(\cdot)$：标准正态分布的累积分布函数

### 估计输入参数的注意事项

Black-Scholes 模型在**连续时间**（continuous time）框架下运作，这对输入参数有两个重要影响：

**1. 无风险利率的转换**

模型使用连续复利形式的无风险利率。如果你只有年化的离散利率（如国债收益率），需要转换：

$$
r_{\text{连续}} = \ln(1 + r_{\text{离散}})
$$

例如，如果一年期国债利率为 6.2%，则：

$$
r_{\text{连续}} = \ln(1.062) = 0.0602 = 6.02\%
$$

**为什么要这样转换？** 因为 Black-Scholes 公式中的 $e^{-rt}$ 假设的是连续复利。如果直接使用离散利率，会导致折现因子的轻微偏差。

**2. 波动率的年化**

模型需要**年化的对数收益率标准差**。如果你使用周收益率或月收益率估计波动率，需要年化：

$$
\sigma_{\text{年化}} = \sigma_{\text{周}} \times \sqrt{52} = \sigma_{\text{月}} \times \sqrt{12}
$$

**为什么用 $\sqrt{52}$ 而不是 52？** 这源于一个关键的统计性质：如果收益率没有序列相关性，方差在时间上是**线性叠加**的。因此：

$$
\sigma^2_{\text{年}} = 52 \times \sigma^2_{\text{周}} \implies \sigma_{\text{年}} = \sqrt{52} \times \sigma_{\text{周}}
$$

::: {.callout-tip}
## 实践建议

- 使用至少 2-3 年的历史价格数据估计波动率
- 周收益率比日收益率更稳定（减少噪音）
- 如果公司近期有重大事件（如并购），考虑是否使用更短的估计窗口
:::

### 公式的直觉解读

Black-Scholes 公式看起来很复杂，但我们可以将其拆解为两部分：

$$
C = \underbrace{S \cdot N(d_1)}_{\text{买入股票}} - \underbrace{K e^{-rt} \cdot N(d_2)}_{\text{借款}}
$$

- **$S \cdot N(d_1)$**：复制组合中股票部分的价值。$N(d_1)$ 是期权的 Delta，表示需要持有多少股股票
- **$K e^{-rt} \cdot N(d_2)$**：复制组合中借款部分的价值。$K e^{-rt}$ 是执行价格的现值，$N(d_2)$ 近似等于期权到期时实值的概率

::: {.callout-note}
## $N(d_2)$ 的概率解释

$N(d_2)$ 可以近似理解为：在风险中性世界中，期权到期时处于实值状态（$S > K$）的概率。这不是真实世界的概率，而是定价所需的"风险中性概率"。
:::

### 计算实例：Cisco 期权估值

**设定**（2001 年 3 月 6 日）：

- Cisco 股价 $S = 13.62$ 美元
- 执行价格 $K = 15$ 美元
- 到期时间 $t = 103/365 = 0.2822$ 年
- 无风险利率 $r = 4.63\%$
- 年化波动率 $\sigma = 81\%$（根据历史周收益率估计：$11.23\% \times \sqrt{52} = 81\%$）

**计算**：

$$
d_1 = \frac{\ln(13.62/15) + (0.0463 + 0.81^2/2) \times 0.2822}{0.81 \times \sqrt{0.2822}} = 0.0212
$$

$$
d_2 = 0.0212 - 0.81 \times \sqrt{0.2822} = -0.4091
$$

查标准正态分布表：

- $N(d_1) = N(0.0212) = 0.5085$
- $N(d_2) = N(-0.4091) = 0.3412$

**期权价值**：

$$
C = 13.62 \times 0.5085 - 15 \times e^{-0.0463 \times 0.2822} \times 0.3412 = \$1.87
$$

当时市场价格为 2 美元，略高于模型估值。这可能意味着市场认为的波动率比 81% 更高。

### 隐含波动率

如果我们把市场价格代入 Black-Scholes 公式，反推出来的波动率称为**隐含波动率（Implied Volatility）**。

在上面的例子中，如果期权市价是 2 美元，反推的隐含波动率约为 85.4%。

隐含波动率是市场对未来波动性的预期，通常被认为比历史波动率更具前瞻性。

---

## 模型的局限性与修正

Black-Scholes 模型是为最简单的情况设计的：欧式期权、无股息、期权行权不影响标的资产价值。现实世界更复杂，需要对模型进行修正。

### 股息调整

股息支付会降低股价，从而影响期权价值。有两种处理方法：

**方法一：短期期权——扣除股息现值**

$$
\text{调整后股价} = S - \text{PV}(\text{期权期限内的股息})
$$

**方法二：长期期权——使用股息收益率**

如果股息收益率 $y$ 在期权期限内保持稳定，修正后的 Black-Scholes 公式为：

$$
C = S e^{-yt} N(d_1) - K e^{-rt} N(d_2)
$$

$$
d_1 = \frac{\ln(S/K) + (r - y + \sigma^2/2)t}{\sigma\sqrt{t}}
$$

**直觉解释**：

1. 资产价值以股息收益率折现，反映了持有期权而非股票所错过的股息
2. 利率被股息收益率抵消，反映了复制组合中持有股票的"隐性收益"

#### 案例：AT&T 短期期权的股息调整

2001 年 3 月 6 日，AT&T 股价为 $20.50。考虑一份执行价格为 $20、7 月 20 日到期的看涨期权。基于历史价格，AT&T 股价对数的年化标准差为 60%。在期权期限内，有一笔 $0.15 的股息将在 23 天后支付。无风险利率为 4.63%。

**Step 1：扣除股息现值**

$$
\text{股息现值} = \frac{\$0.15}{1.0463^{23/365}} = \$0.15
$$

$$
\text{调整后股价} = \$20.50 - \$0.15 = \$20.35
$$

**Step 2：计算 Black-Scholes 输入**

- $S = \$20.35$（调整后）
- $K = \$20$
- $t = 103/365 = 0.2822$ 年
- $\sigma^2 = 0.36$（即 $\sigma = 60\%$）
- $r = 4.63\%$

**Step 3：计算 $d_1$ 和 $d_2$**

$$
d_1 = \frac{\ln(20.35/20) + (0.0463 + 0.36/2) \times 0.2822}{0.6 \times \sqrt{0.2822}} = 0.2551
$$

$$
d_2 = 0.2551 - 0.6 \times \sqrt{0.2822} = -0.0636
$$

**Step 4：查标准正态分布表**

- $N(d_1) = N(0.2551) = 0.6007$
- $N(d_2) = N(-0.0636) = 0.4746$

**Step 5：计算期权价值**

$$
C = 20.35 \times 0.6007 - 20 \times e^{-0.0463 \times 0.2822} \times 0.4746 = \$2.86
$$

当时市场价格为 $2.60，模型略微高估。这可能意味着市场预期的波动率低于 60%。

#### 案例：AT&T 长期期权的股息收益率调整

同样是 2001 年 3 月 6 日，CBOE 交易一份 2003 年 1 月 17 日到期的 AT&T 看涨期权，执行价格为 $20。对于这种接近两年期限的期权，逐笔扣除股息不太实际，我们改用**股息收益率法**。

假设 AT&T 的股息收益率在期权期限内保持 2.51%，两年期国债利率为 4.85%。

**输入参数**：

- $S = \$20.50$
- $K = \$20$
- $t = 1.8333$ 年
- $\sigma = 60\%$
- $r = 4.85\%$
- $y = 2.51\%$（股息收益率）

**计算**：

$$
d_1 = \frac{\ln(20.50/20) + (0.0485 - 0.0251 + 0.36/2) \times 1.8333}{0.6 \times \sqrt{1.8333}} = 0.4894
$$

$$
d_2 = 0.4894 - 0.6 \times \sqrt{1.8333} = -0.3230
$$

- $N(d_1) = 0.6877$
- $N(d_2) = 0.3733$

$$
C = 20.50 \times e^{-0.0251 \times 1.8333} \times 0.6877 - 20 \times e^{-0.0485 \times 1.8333} \times 0.3733 = \$6.63
$$

当时市场价格为 $5.80。模型高估了约 14%，可能原因：
1. 市场预期的波动率低于 60%
2. 市场担心早期行权的可能性（美式期权）

::: {.callout-note}
## 短期 vs 长期股息调整的选择

| 期权期限 | 推荐方法 | 原因 |
|----------|----------|------|
| < 6 个月 | 扣除股息现值 | 股息金额和时间较确定 |
| > 1 年 | 股息收益率法 | 难以预测具体股息 |
| 6 个月 - 1 年 | 视情况而定 | 如果股息稳定，用收益率法 |
:::

### 提前行权：美式期权

Black-Scholes 模型假设期权只能在到期日行权（欧式期权）。但美式期权可以提前行权。

**何时可能提前行权？**

1. **看涨期权 + 高股息**：如果股息大于期权的剩余时间价值，可能在除息日前提前行权
2. **深度实值看跌期权 + 高利率**：提前行权获得现金，赚取利息

**处理方法**：

1. **保守估计**：用 Black-Scholes 计算的欧式期权价值作为下限
2. **伪美式估值**：分别计算到每个除息日的期权价值，取最大值
3. **二叉树模型**：在每个节点检查是否应该提前行权

#### 案例：伪美式估值——多除息日的处理

考虑一份执行价格为 $35 的看涨期权，标的股票当前价格为 $40。股价对数的方差为 0.05，无风险利率为 4%。期权还有 8 个月到期，在此期间预计有三次股息：

| 预期股息 | 除息日 |
|----------|--------|
| $0.80 | 1 个月后 |
| $0.80 | 4 个月后 |
| $0.80 | 7 个月后 |

**方法：分别估值到每个除息日**

**估值 1：到第一个除息日前（1 个月）**

直接使用当前股价（此时还没有股息扣除）：

- $S = \$40$, $K = \$35$, $t = 1/12$
- $\sigma^2 = 0.05$, $r = 4\%$

$$
\text{期权价值} = \$5.131
$$

**估值 2：到第二个除息日前（4 个月）**

扣除第一笔股息的现值：

$$
\text{调整后股价} = \$40 - \frac{\$0.80}{1.04^{1/12}} = \$39.20
$$

- $S = \$39.20$, $K = \$35$, $t = 4/12$
- $\sigma^2 = 0.05$, $r = 4\%$

$$
\text{期权价值} = \$5.073
$$

**估值 3：到第三个除息日前（7 个月）**

扣除前两笔股息的现值：

$$
\text{调整后股价} = \$40 - \frac{\$0.80}{1.04^{1/12}} - \frac{\$0.80}{1.04^{4/12}} = \$38.41
$$

- $S = \$38.41$, $K = \$35$, $t = 7/12$

$$
\text{期权价值} = \$5.128
$$

**估值 4：到期权到期日（8 个月）**

扣除所有三笔股息的现值：

$$
\text{调整后股价} = \$40 - \frac{\$0.80}{1.04^{1/12}} - \frac{\$0.80}{1.04^{4/12}} - \frac{\$0.80}{1.04^{7/12}} = \$37.63
$$

- $S = \$37.63$, $K = \$35$, $t = 8/12$

$$
\text{期权价值} = \$4.757
$$

**结论：选择最大值**

| 估值时点 | 期权价值 |
|----------|----------|
| 第一个除息日前 | **$5.131** ← 最大 |
| 第二个除息日前 | $5.073 |
| 第三个除息日前 | $5.128 |
| 到期日 | $4.757 |

伪美式估值 = **$5.131**

::: {.callout-important}
## 伪美式估值的洞察

这个案例揭示了一个重要现象：**期权价值并非总是随着期限增长而增加**。

为什么到第一个除息日的价值最高？因为：
1. 此时股价尚未被股息"侵蚀"
2. 虽然时间短（只有 1 个月），但深度实值期权的时间价值本就有限

这解释了为什么高股息股票的看涨期权更可能被提前行权——持有者不愿错过股息。
:::

#### 方法 2：使用二叉树模型处理早期行权

二叉树模型更灵活，因为它可以在**每个节点**检查是否应该提前行权。步骤如下：

**Step 1**：用 Black-Scholes 的波动率估计转换为二叉树参数（见前文的转换公式）

**Step 2**：在每个除息日节点，股价下降股息金额

**Step 3**：在每个节点，比较：
- 立即行权的价值：$\max(S - K, 0)$
- 继续持有的价值（折现后期望值）

**Step 4**：选择两者中的较大值

### 行权对标的资产的影响：权证估值

对于普通期权，行权不会影响标的资产价值。但对于公司发行的**权证（Warrant）**，行权会增加流通股数量，稀释每股价值。

**稀释调整**：

$$
\text{调整后股价} = \frac{S \times n_S + W \times n_W}{n_S + n_W}
$$

其中：

- $S$：当前股价
- $n_S$：流通股数量
- $W$：权证价值
- $n_W$：权证数量

这个公式有循环问题（需要权证价值来计算调整后股价，需要调整后股价来计算权证价值），需要迭代求解。

#### 案例：Avatek Corporation 权证估值

Avatek Corporation 是一家房地产公司，2001 年 3 月的情况如下：

| 项目 | 数值 |
|------|------|
| 流通股数 | 1963.7 万股 |
| 股价 | $0.38 |
| 权证数量 | 180 万份 |
| 权证执行价格 | $2.25 |
| 权证期限 | 4 年 |
| 股价对数标准差 | 93% |
| 股息收益率 | 0% |
| 四年期国债利率 | 4.9% |
| 权证市场价格 | $0.12 |

**Step 1：估算初始权证价值（用于调整股价）**

我们先用市场价格 $0.12 作为初始估计。

**Step 2：计算稀释调整后股价**

$$
\text{调整后股价} = \frac{S \times n_S + W \times n_W}{n_S + n_W} = \frac{0.38 \times 19.637 + 0.12 \times 1.8}{19.637 + 1.8} = \$0.3544
$$

**Step 3：用调整后股价计算权证价值**

输入参数：
- $S = \$0.3544$（调整后）
- $K = \$2.25$
- $t = 4$ 年
- $\sigma = 93\%$
- $r = 4.9\%$
- $y = 0\%$

计算 $d_1$ 和 $d_2$：

$$
d_1 = \frac{\ln(0.3544/2.25) + (0.049 + 0.93^2/2) \times 4}{0.93 \times \sqrt{4}} = 0.0418
$$

$$
d_2 = 0.0418 - 0.93 \times 2 = -1.8182
$$

查表：
- $N(d_1) = 0.5167$
- $N(d_2) = 0.0345$

**Step 4：计算权证价值**

$$
W = 0.3544 \times 0.5167 - 2.25 \times e^{-0.049 \times 4} \times 0.0345 = \$0.12
$$

**结果**：模型估值恰好等于市场价格 $0.12，无需进一步迭代。

::: {.callout-note}
## 迭代过程说明

如果模型估值与初始假设不同，需要迭代：

1. 用新的权证估值重新计算调整后股价
2. 用新的调整后股价重新计算权证价值
3. 重复直到收敛（通常 3-5 次迭代即可）

对于非交易的管理层期权（没有市场价格），迭代过程必不可少。
:::

::: {.callout-warning}
## 为什么稀释会降低权证价值？

直觉上，稀释调整有两个效应：

1. **股价下调**：将权证市值加入分子，但股数增加更多在分母，导致每股价值下降
2. **现金流入**：权证行权会给公司带来现金（执行价格 × 权证数量）

第二个效应是正面的，但通常**无法完全抵消**第一个效应，因为：
- 只有在 $S > K$ 时权证才会被行权
- 行权时公司收到的是执行价格，而稀释的是当前较高的股价
:::

---

## 跳跃过程期权定价模型

### 当价格不连续变化时

Black-Scholes 模型假设资产价格**连续变化**——价格在相邻时刻之间不会出现跳跃。但在现实中，某些事件（如盈利公告、FDA 审批结果、并购消息）会导致价格**瞬间大幅跳跃**。

如果在二叉树模型中，即使时间步长变得很短，价格变化仍然保持很大，那么连续价格过程的假设就不再适用。

### Cox-Ross 纯跳跃模型（1976）

Cox 和 Ross 提出了一个纯跳跃过程模型，假设：
- 股价要么保持不变（小概率向下漂移）
- 要么出现大幅正向跳跃

这种模型适用于高度不确定的事件驱动型资产，如等待重大监管审批的生物科技公司。

### Merton 跳跃扩散模型（1976）

Merton 提出了更一般化的模型，将**跳跃叠加在连续价格过程上**。模型需要两个额外参数：

- $\lambda$：跳跃发生的频率（每年预期跳跃次数）
- $k$：平均跳跃幅度（以股价百分比衡量）

跳跃扩散模型的期权价值由 Black-Scholes 的五个变量加上跳跃参数 $(\lambda, k)$ 共同决定。

::: {.callout-warning}
## 跳跃模型的实践局限

虽然跳跃扩散模型更贴近现实，但存在严重的**参数估计问题**：

1. **跳跃频率难以估计**：历史上的跳跃样本很少
2. **跳跃幅度不稳定**：不同事件导致的跳跃差异巨大
3. **估计误差可能超过模型改进带来的收益**

因此，跳跃模型在实践中应用有限。对于大多数期权，使用 Black-Scholes 配合适当的隐含波动率是更务实的选择。
:::

::: {.callout-tip}
## 何时考虑跳跃模型？

| 场景 | 建议 |
|------|------|
| 等待 FDA 审批的生物科技公司 | 考虑跳跃模型或情景分析 |
| 面临重大诉讼的公司 | 考虑跳跃模型 |
| 正常运营的成熟公司 | Black-Scholes 足够 |
| 短期交易期权 | Black-Scholes + 隐含波动率 |
:::

---

## 期权定价的扩展：更复杂的期权类型

标准期权之外，还有许多变体。理解这些变体对于**实物期权**的应用至关重要。

### 上限期权与障碍期权

**上限期权（Capped Option）**：收益有上限。例如，执行价格为 $K_1$ 的看涨期权，当资产价格超过 $K_2$ 时，收益被封顶在 $(K_2 - K_1)$。

**近似估值**：

$$
\text{上限看涨期权价值} \approx C(K = K_1) - C(K = K_2)
$$

**障碍期权（Barrier Option）**：期权的存续或收益取决于标的资产是否触及某个价格水平。

#### 障碍期权的四种基本类型

| 类型 | 障碍位置 | 触及障碍后 | 适用场景 |
|------|----------|-----------|----------|
| **向下敲出（Down-and-Out）** | 执行价格以下 | 期权失效 | 看涨期权 |
| **向上敲出（Up-and-Out）** | 执行价格以上 | 期权失效 | 看跌期权 |
| **向下敲入（Down-and-In）** | 执行价格以下 | 期权生效 | 看涨期权 |
| **向上敲入（Up-and-In）** | 执行价格以上 | 期权生效 | 看跌期权 |

**定价关系**：

对于相同参数的障碍期权，有一个优雅的关系：

$$
\text{敲入期权} + \text{敲出期权} = \text{普通期权}
$$

这意味着如果你能定价敲出期权，就能通过差值得到敲入期权。

**为什么障碍期权更便宜？**

因为它们的收益被"截断"了。敲出期权可能在到期前就失效；敲入期权可能永远不生效。这种限制降低了期权价值。

::: {.callout-warning}
## 实物期权的启示

许多实物期权都有类似的"上限"或"障碍"特征：

| 实物期权场景 | 对应的障碍特征 |
|--------------|---------------|
| 专利保护的技术开发权 | 专利到期 = 敲出障碍 |
| 政府特许经营权 | 特许期限 = 时间障碍 |
| 自然资源开采权 | 储量耗尽 = 向下敲出 |
| 竞争对手抢先进入市场 | 市场份额降至阈值 = 敲出 |

忽略这些限制会导致**高估**实物期权的价值。
:::

### 复合期权

**复合期权（Compound Option）**的标的资产本身是另一个期权。例如：

- 看涨期权的看涨期权（Call on a Call）
- 看跌期权的看跌期权（Put on a Put）

**实物期权中的应用**：

分阶段投资的项目可以被视为复合期权。第一阶段的投资给予公司进行第二阶段投资的"权利"，第二阶段又给予第三阶段的权利，以此类推。

### 彩虹期权

**彩虹期权（Rainbow Option）**的价值取决于多个不确定性来源。

**例子**：未开发油田

这是一个典型的实物期权。但它的价值不仅取决于油价（不确定性来源 1），还取决于油田的储量（不确定性来源 2）。用单一标的资产的期权模型来估值会产生偏差。

---

## 看跌期权与看涨-看跌平价

### Put-Call Parity

如果我们知道看涨期权的价值，可以通过**看涨-看跌平价关系（Put-Call Parity）**推导出同等条件看跌期权的价值：

$$
C - P = S - K e^{-rt}
$$

或等价地：

$$
P = C - S + K e^{-rt}
$$

**直觉解释**：

考虑以下组合：

1. 卖出一份看涨期权（收入 $C$）
2. 买入一份看跌期权（支出 $P$）
3. 买入一股股票（支出 $S$）

这个组合在到期时的收益恒等于 $K$，无论股价如何变化。因此，组合的成本必须等于 $K$ 的现值：

$$
S + P - C = K e^{-rt}
$$

### Black-Scholes 看跌期权公式

将 Black-Scholes 看涨期权公式代入 Put-Call Parity：

$$
P = K e^{-rt} [1 - N(d_2)] - S e^{-yt} [1 - N(d_1)]
$$

对于无股息资产（$y = 0$）：

$$
P = K e^{-rt} N(-d_2) - S N(-d_1)
$$

### 案例：用 Put-Call Parity 估值看跌期权

让我们用前面的 Cisco 和 AT&T 案例来演示看跌期权的估值。

#### Cisco 看跌期权

回顾 Cisco 看涨期权的估值：
- 股价 $S = \$13.62$
- 执行价格 $K = \$15$
- 到期时间 $t = 103/365 = 0.2822$ 年
- 无风险利率 $r = 4.63\%$
- 看涨期权价值 $C = \$1.87$

用 Put-Call Parity：

$$
P = C - S + K e^{-rt} = 1.87 - 13.62 + 15 \times e^{-0.0463 \times 0.2822} = \$3.06
$$

当时市场价格为 $3.38，模型略微低估。

#### AT&T 长期看跌期权

回顾 AT&T 长期看涨期权的估值：
- 股价 $S = \$20.50$
- 执行价格 $K = \$20$
- 到期时间 $t = 1.8333$ 年
- 无风险利率 $r = 4.85\%$
- 股息收益率 $y = 2.51\%$
- 看涨期权价值 $C = \$6.63$

对于有股息的资产，Put-Call Parity 需要调整：

$$
P = C - S e^{-yt} + K e^{-rt}
$$

$$
P = 6.63 - 20.50 \times e^{-0.0251 \times 1.8333} + 20 \times e^{-0.0485 \times 1.8333} = \$5.35
$$

当时市场价格为 $3.80。模型高估了 41%！

::: {.callout-important}
## 模型 vs 市场价格差异的含义

Cisco 和 AT&T 的看涨/看跌期权**同时**与模型估值不同，这说明：

1. **波动率估计可能有误**：我们使用历史波动率，但市场可能预期更低（或更高）的未来波动率
2. **美式期权溢价**：市场价格反映了提前行权的价值，而 Black-Scholes 假设欧式期权
3. **Put-Call Parity 始终成立**：如果 Call 高估，Put 也会高估（反之亦然），因为它们通过套利关系相连

**实践启示**：如果模型价格与市场价格不同，反推**隐含波动率**通常比质疑市场更有意义。
:::

---

## 总结

::: {.callout-important}
## 核心要点

- **期权是收益不对称的资产**：下行风险有限，上行潜力巨大，不能用简单的现金流折现估值
- **波动性是期权的朋友**：与其他资产不同，期权价值随波动性增加而增加
- **无套利定价**：期权价值等于复制组合的成本——用标的资产和无风险借贷复制期权收益
- **六大定价因素**：标的资产价格、执行价格、波动率、到期时间、无风险利率、股息
- **Black-Scholes 模型**是二叉树模型在连续时间下的极限，五个输入变量可以定价欧式期权
- **模型需要修正**：考虑股息、提前行权可能性、稀释效应等现实因素
:::

本章回答了开头提出的问题：期权之所以不能用简单的现金流折现估值，是因为期权持有者有选择权——可以选择行权或放弃。这种选择权本身就有价值，而这个价值可以通过构建复制组合、利用无套利原则来精确计算。

关键的 takeaway 是：**期权定价的核心不是预测未来价格，而是找到一个让套利者无利可图的"公平"价格**。这个思想将在后续章节中延伸到实物期权的估值——企业拥有的延迟投资、扩张或放弃项目的选择权，本质上都是期权。

---

## 思考题

1. 假设一只股票的波动率为 0（价格完全确定），此时一份平值（ATM）看涨期权的价值是多少？提示：考虑执行价格的现值。

2. 为什么深度实值（Deep ITM）的美式看涨期权可能在高股息股票的除息日前被提前行权？在什么条件下，持有者会选择提前行权而非继续持有？

3. 考虑一家生物科技公司，正在等待 FDA 对新药的审批结果。如果获批，公司价值翻倍；如果被拒，公司价值减半。这种情况适合用 Black-Scholes 模型估值吗？为什么？提示：考虑价格的连续性假设。

4. 权证的稀释效应会降低权证价值。但如果权证被行权，公司会收到现金。这笔现金能否完全抵消稀释效应？为什么？

5. 在实物期权的背景下，"执行价格"和"标的资产价值"分别对应什么？例如，对于一个尚未开发的油田，执行价格是什么？标的资产价值又是什么？

---

[^source]: 本文为教学化改写与总结，主要依据 Aswath Damodaran《Investment Valuation》Chapter 5: Option Pricing Theory and Models。
