---
title: "【第5章】期权定价理论与模型：从直觉到 Black-Scholes"
description: "理解期权为何不能用简单的现金流折现来估值，以及如何通过复制组合和无套利原理推导出期权定价公式。"
author: "Ying"
date: "2025-12-05"
lang: zh
categories: [金融, 投资, 估值]
tags: [Valuation, Damodaran, 期权, Black-Scholes, 二叉树模型, 实物期权]
format:
  html:
    toc: true
    toc-depth: 3
    number-sections: true
    html-math-method: mathjax
---

## 从一个问题开始

在估值的世界里，我们通常遵循一条基本原则：**任何资产的价值等于其预期现金流的现值**。但有一类特殊的资产打破了这条规则。

想象一下：你花 5 美元买了一张"权利"，这张权利允许你在三个月后以 100 美元的价格买入某只股票。如果三个月后股票涨到 120 美元，你赚了 15 美元（120 - 100 - 5）；如果股票跌到 90 美元，你会选择不行使这个权利，最多亏损 5 美元。

这就是**期权（Option）**——一种收益不对称的金融工具。它的价值不能简单地用"预期现金流折现"来计算，因为期权持有者可以选择是否行使权利。

你可能会问：

- 为什么波动性越大，期权越值钱？（这似乎与我们对"风险"的直觉相悖！）
- 如何在没有套利机会的前提下，给期权定一个"公平"的价格？
- 著名的 Black-Scholes 公式是如何推导出来的？它背后的核心逻辑是什么？

本章将深入探讨这些问题，并为后续章节中**实物期权（Real Options）**的应用打下基础。

---

## 期权的基本构造：权利而非义务

### 看涨期权与看跌期权

期权赋予持有者以固定价格（称为**执行价格**或**行权价**，Strike Price）在到期日或到期日前买入或卖出标的资产的**权利**——注意，是权利，不是义务。

::: {.callout-important}
## 期权的两种基本类型

- **看涨期权（Call Option）**：持有者有权在到期日或之前以执行价格**买入**标的资产
- **看跌期权（Put Option）**：持有者有权在到期日或之前以执行价格**卖出**标的资产
:::

让我们用一个具体的例子来理解。

**看涨期权的收益结构**：

假设你买了一份执行价格为 100 美元的看涨期权，支付了 5 美元的期权费。到期时：

- 如果股价 = 120 美元：行权，买入股票，**净收益 = 120 - 100 - 5 = 15 美元**
- 如果股价 = 100 美元：不行权，**净收益 = -5 美元**（仅损失期权费）
- 如果股价 = 80 美元：不行权，**净收益 = -5 美元**

关键观察：**下行风险有限（最多损失期权费），上行潜力无限**。

**看跌期权的收益结构**：

假设你买了一份执行价格为 100 美元的看跌期权，支付了 5 美元的期权费。到期时：

- 如果股价 = 80 美元：行权，以 100 美元卖出，**净收益 = 100 - 80 - 5 = 15 美元**
- 如果股价 = 100 美元：不行权，**净收益 = -5 美元**
- 如果股价 = 120 美元：不行权，**净收益 = -5 美元**

### 美式期权与欧式期权

- **欧式期权（European Option）**：只能在到期日行权
- **美式期权（American Option）**：可以在到期日或之前任何时间行权

美式期权的灵活性使其价值至少等于同等条件的欧式期权。但在大多数情况下，由于期权存在**时间价值**，提前行权并不划算——持有者通常能通过卖出期权获得比提前行权更高的收益。

---

## 决定期权价值的六个因素

期权的价值由六个变量决定。理解这些变量如何影响期权价值，是掌握期权定价的第一步。

### 六大因素及其影响

| 因素 | 对看涨期权价值的影响 | 对看跌期权价值的影响 | 直觉解释 |
|------|----------------------|----------------------|----------|
| 标的资产现价 $S$ ↑ | ↑ 增加 | ↓ 减少 | 看涨期权是买入的权利，资产越贵，买入权利越值钱 |
| 执行价格 $K$ ↑ | ↓ 减少 | ↑ 增加 | 执行价格越高，看涨期权越难盈利 |
| 标的资产波动率 $\sigma$ ↑ | ↑ 增加 | ↑ 增加 | **关键洞察**：波动性对期权是好事！ |
| 到期时间 $t$ ↑ | ↑ 增加 | ↑ 增加 | 时间越长，资产价格大幅变动的可能性越大 |
| 无风险利率 $r$ ↑ | ↑ 增加 | ↓ 减少 | 利率越高，执行价格的现值越低 |
| 标的资产股息 $D$ ↑ | ↓ 减少 | ↑ 增加 | 股息支付会降低股价 |

### 为什么波动性越大，期权越值钱？

这是期权定价中最反直觉的一点。在其他资产估值中，波动性（风险）通常是负面的——我们会要求更高的折现率来补偿风险。但对于期权，情况完全不同。

**直觉解释**：

期权持有者的损失是有限的（最多损失期权费），但收益潜力是无限的。高波动性意味着：

- 资产价格大幅上涨的概率增加 → 看涨期权可能获得巨大收益
- 资产价格大幅下跌的概率也增加 → 但看涨期权的损失仍然有限

这种**收益不对称性**使得波动性成为期权持有者的朋友。

**数学解释**：

考虑一个简单的二元世界：股票当前价格 100 美元，可能涨到 110 或跌到 90。看涨期权（执行价格 100）的期望收益是：

$$
E[\text{收益}] = 0.5 \times (110 - 100) + 0.5 \times 0 = 5
$$

现在假设波动性增加：股票可能涨到 130 或跌到 70。期望收益变成：

$$
E[\text{收益}] = 0.5 \times (130 - 100) + 0.5 \times 0 = 15
$$

虽然下行风险也增加了，但期权持有者不在乎——因为亏损被锁定在期权费。

::: {.callout-note}
## 关于波动性的微妙之处

对于深度实值（Deep In-the-Money）的看涨期权，其行为越来越像标的资产本身。在这种极端情况下，高波动性可能降低标的资产的价值，从而间接降低期权价值。但对于大多数期权，波动性仍然是正面因素。
:::

---

## 二叉树模型：从离散世界理解期权定价

### 核心思想：复制组合

期权定价的核心逻辑是**无套利原则**：如果我们能用标的资产和无风险借贷构建一个组合，使其在任何情况下的收益都与期权完全相同，那么这个组合的成本就是期权的价值。

这个组合被称为**复制组合（Replicating Portfolio）**。

### 单期二叉树模型

假设股票当前价格为 $S$，在一个时期后可能上涨到 $Su$ 或下跌到 $Sd$：

```
         Su (上涨)
        /
       S
        \
         Sd (下跌)
```

对于执行价格为 $K$ 的看涨期权：

- 如果股价上涨到 $Su$：期权价值 $C_u = \max(Su - K, 0)$
- 如果股价下跌到 $Sd$：期权价值 $C_d = \max(Sd - K, 0)$

**构建复制组合**：

我们要找到 $\Delta$ 股股票和 $B$ 美元借款的组合，使得：

- 上涨时：$\Delta \times Su - B(1+r) = C_u$
- 下跌时：$\Delta \times Sd - B(1+r) = C_d$

解这个方程组：

$$
\Delta = \frac{C_u - C_d}{Su - Sd}
$$

这个 $\Delta$ 被称为**期权的 Delta**，表示复制一份期权需要持有多少股票。

### 具体数值例子

让我们用一个完整的例子来演示二叉树定价。

**设定**：

- 当前股价 $S = 50$ 美元
- 上涨因子 $u = 1.4$（股价可能涨到 70）
- 下跌因子 $d = 0.7$（股价可能跌到 35）
- 执行价格 $K = 40$ 美元
- 无风险利率 $r = 11\%$
- 期权期限：2 期

**两期二叉树**：

```
t=0          t=1          t=2
                         100 (=70×1.4)
              70
             /  \
            /    50 (=70×0.7 或 35×1.4)
           /
         50
           \
            \
             35
              \
               25 (=35×0.7)
```

**Step 1：计算终点的期权价值**

- 股价 = 100：$C = \max(100-40, 0) = 60$
- 股价 = 50：$C = \max(50-40, 0) = 10$
- 股价 = 25：$C = \max(25-40, 0) = 0$

**Step 2：从 t=1 节点反向计算**

在 $S = 70$ 节点：

$$
\Delta = \frac{60 - 10}{100 - 50} = 1
$$

复制组合需要买入 1 股股票。借款金额 $B$ 满足：

$$
70 \times 1 - B = \frac{60 + 10 \times 0}{1.11} \times \frac{C_u \text{和} C_d \text{的折现}}{...}
$$

更直接地，期权价值 = $70 \times 1 - 36.04 = 33.96$ 美元

在 $S = 35$ 节点：

$$
\Delta = \frac{10 - 0}{50 - 25} = 0.4
$$

期权价值 = $35 \times 0.4 - 9.01 = 4.99$ 美元

**Step 3：计算 t=0 的期权价值**

$$
\Delta = \frac{33.96 - 4.99}{70 - 35} = 0.8278
$$

期权价值 = $50 \times 0.8278 - 21.61 = \$19.42$

::: {.callout-tip}
## 二叉树模型的关键洞察

1. **期权价值不依赖于上涨/下跌的概率**——只要无套利，复制组合的成本就是期权价值
2. **Delta 是动态变化的**——在不同节点，复制组合需要不断调整
3. **期权价值由当前价格决定**，而非预期未来价格（当前价格已经反映了市场预期）
:::

---

## Black-Scholes 模型：连续世界的期权定价

### 从二叉树到连续

当我们把二叉树模型的时间间隔无限细分，价格变化变得连续时，二叉树模型就收敛到著名的 **Black-Scholes 模型**。

1973 年，Fischer Black 和 Myron Scholes 发表了开创性论文，为欧式期权提供了一个封闭解。这个模型为 Scholes 赢得了 1997 年诺贝尔经济学奖（Black 已于 1995 年去世）。

### Black-Scholes 公式

**看涨期权价值**：

$$
C = S \cdot N(d_1) - K e^{-rt} \cdot N(d_2)
$$

其中：

$$
d_1 = \frac{\ln(S/K) + (r + \sigma^2/2)t}{\sigma\sqrt{t}}
$$

$$
d_2 = d_1 - \sigma\sqrt{t}
$$

**变量含义**：

- $S$：标的资产当前价格
- $K$：执行价格
- $t$：到期时间（年）
- $r$：无风险利率（连续复利）
- $\sigma$：标的资产价格对数的年化标准差
- $N(\cdot)$：标准正态分布的累积分布函数

### 公式的直觉解读

Black-Scholes 公式看起来很复杂，但我们可以将其拆解为两部分：

$$
C = \underbrace{S \cdot N(d_1)}_{\text{买入股票}} - \underbrace{K e^{-rt} \cdot N(d_2)}_{\text{借款}}
$$

- **$S \cdot N(d_1)$**：复制组合中股票部分的价值。$N(d_1)$ 是期权的 Delta，表示需要持有多少股股票
- **$K e^{-rt} \cdot N(d_2)$**：复制组合中借款部分的价值。$K e^{-rt}$ 是执行价格的现值，$N(d_2)$ 近似等于期权到期时实值的概率

::: {.callout-note}
## $N(d_2)$ 的概率解释

$N(d_2)$ 可以近似理解为：在风险中性世界中，期权到期时处于实值状态（$S > K$）的概率。这不是真实世界的概率，而是定价所需的"风险中性概率"。
:::

### 计算实例：Cisco 期权估值

**设定**（2001 年 3 月 6 日）：

- Cisco 股价 $S = 13.62$ 美元
- 执行价格 $K = 15$ 美元
- 到期时间 $t = 103/365 = 0.2822$ 年
- 无风险利率 $r = 4.63\%$
- 年化波动率 $\sigma = 81\%$（根据历史周收益率估计：$11.23\% \times \sqrt{52} = 81\%$）

**计算**：

$$
d_1 = \frac{\ln(13.62/15) + (0.0463 + 0.81^2/2) \times 0.2822}{0.81 \times \sqrt{0.2822}} = 0.0212
$$

$$
d_2 = 0.0212 - 0.81 \times \sqrt{0.2822} = -0.4091
$$

查标准正态分布表：

- $N(d_1) = N(0.0212) = 0.5085$
- $N(d_2) = N(-0.4091) = 0.3412$

**期权价值**：

$$
C = 13.62 \times 0.5085 - 15 \times e^{-0.0463 \times 0.2822} \times 0.3412 = \$1.87
$$

当时市场价格为 2 美元，略高于模型估值。这可能意味着市场认为的波动率比 81% 更高。

### 隐含波动率

如果我们把市场价格代入 Black-Scholes 公式，反推出来的波动率称为**隐含波动率（Implied Volatility）**。

在上面的例子中，如果期权市价是 2 美元，反推的隐含波动率约为 85.4%。

隐含波动率是市场对未来波动性的预期，通常被认为比历史波动率更具前瞻性。

---

## 模型的局限性与修正

Black-Scholes 模型是为最简单的情况设计的：欧式期权、无股息、期权行权不影响标的资产价值。现实世界更复杂，需要对模型进行修正。

### 股息调整

股息支付会降低股价，从而影响期权价值。有两种处理方法：

**方法一：短期期权——扣除股息现值**

$$
\text{调整后股价} = S - \text{PV}(\text{期权期限内的股息})
$$

**方法二：长期期权——使用股息收益率**

如果股息收益率 $y$ 在期权期限内保持稳定，修正后的 Black-Scholes 公式为：

$$
C = S e^{-yt} N(d_1) - K e^{-rt} N(d_2)
$$

$$
d_1 = \frac{\ln(S/K) + (r - y + \sigma^2/2)t}{\sigma\sqrt{t}}
$$

**直觉解释**：

1. 资产价值以股息收益率折现，反映了持有期权而非股票所错过的股息
2. 利率被股息收益率抵消，反映了复制组合中持有股票的"隐性收益"

### 提前行权：美式期权

Black-Scholes 模型假设期权只能在到期日行权（欧式期权）。但美式期权可以提前行权。

**何时可能提前行权？**

1. **看涨期权 + 高股息**：如果股息大于期权的剩余时间价值，可能在除息日前提前行权
2. **深度实值看跌期权 + 高利率**：提前行权获得现金，赚取利息

**处理方法**：

1. **保守估计**：用 Black-Scholes 计算的欧式期权价值作为下限
2. **伪美式估值**：分别计算到每个除息日的期权价值，取最大值
3. **二叉树模型**：在每个节点检查是否应该提前行权

### 行权对标的资产的影响：权证估值

对于普通期权，行权不会影响标的资产价值。但对于公司发行的**权证（Warrant）**，行权会增加流通股数量，稀释每股价值。

**稀释调整**：

$$
\text{调整后股价} = \frac{S \times n_S + W \times n_W}{n_S + n_W}
$$

其中：

- $S$：当前股价
- $n_S$：流通股数量
- $W$：权证价值
- $n_W$：权证数量

这个公式有循环问题（需要权证价值来计算调整后股价，需要调整后股价来计算权证价值），需要迭代求解。

---

## 期权定价的扩展：更复杂的期权类型

标准期权之外，还有许多变体。理解这些变体对于**实物期权**的应用至关重要。

### 上限期权与障碍期权

**上限期权（Capped Option）**：收益有上限。例如，执行价格为 $K_1$ 的看涨期权，当资产价格超过 $K_2$ 时，收益被封顶在 $(K_2 - K_1)$。

**近似估值**：

$$
\text{上限看涨期权价值} \approx C(K = K_1) - C(K = K_2)
$$

**障碍期权（Barrier Option）**：期权的存续或收益取决于标的资产是否触及某个价格水平。

- **敲出期权（Knockout Option）**：资产价格触及障碍时期权失效
- **敲入期权（Knockin Option）**：资产价格触及障碍时期权才生效

::: {.callout-warning}
## 实物期权的启示

许多实物期权都有类似的"上限"或"障碍"特征。例如，开发某项专利技术的权利可能有时间限制（专利到期就失效）。忽略这些限制会导致高估实物期权的价值。
:::

### 复合期权

**复合期权（Compound Option）**的标的资产本身是另一个期权。例如：

- 看涨期权的看涨期权（Call on a Call）
- 看跌期权的看跌期权（Put on a Put）

**实物期权中的应用**：

分阶段投资的项目可以被视为复合期权。第一阶段的投资给予公司进行第二阶段投资的"权利"，第二阶段又给予第三阶段的权利，以此类推。

### 彩虹期权

**彩虹期权（Rainbow Option）**的价值取决于多个不确定性来源。

**例子**：未开发油田

这是一个典型的实物期权。但它的价值不仅取决于油价（不确定性来源 1），还取决于油田的储量（不确定性来源 2）。用单一标的资产的期权模型来估值会产生偏差。

---

## 看跌期权与看涨-看跌平价

### Put-Call Parity

如果我们知道看涨期权的价值，可以通过**看涨-看跌平价关系（Put-Call Parity）**推导出同等条件看跌期权的价值：

$$
C - P = S - K e^{-rt}
$$

或等价地：

$$
P = C - S + K e^{-rt}
$$

**直觉解释**：

考虑以下组合：

1. 卖出一份看涨期权（收入 $C$）
2. 买入一份看跌期权（支出 $P$）
3. 买入一股股票（支出 $S$）

这个组合在到期时的收益恒等于 $K$，无论股价如何变化。因此，组合的成本必须等于 $K$ 的现值：

$$
S + P - C = K e^{-rt}
$$

### Black-Scholes 看跌期权公式

将 Black-Scholes 看涨期权公式代入 Put-Call Parity：

$$
P = K e^{-rt} [1 - N(d_2)] - S e^{-yt} [1 - N(d_1)]
$$

对于无股息资产（$y = 0$）：

$$
P = K e^{-rt} N(-d_2) - S N(-d_1)
$$

---

## 总结

::: {.callout-important}
## 核心要点

- **期权是收益不对称的资产**：下行风险有限，上行潜力巨大，不能用简单的现金流折现估值
- **波动性是期权的朋友**：与其他资产不同，期权价值随波动性增加而增加
- **无套利定价**：期权价值等于复制组合的成本——用标的资产和无风险借贷复制期权收益
- **六大定价因素**：标的资产价格、执行价格、波动率、到期时间、无风险利率、股息
- **Black-Scholes 模型**是二叉树模型在连续时间下的极限，五个输入变量可以定价欧式期权
- **模型需要修正**：考虑股息、提前行权可能性、稀释效应等现实因素
:::

本章回答了开头提出的问题：期权之所以不能用简单的现金流折现估值，是因为期权持有者有选择权——可以选择行权或放弃。这种选择权本身就有价值，而这个价值可以通过构建复制组合、利用无套利原则来精确计算。

关键的 takeaway 是：**期权定价的核心不是预测未来价格，而是找到一个让套利者无利可图的"公平"价格**。这个思想将在后续章节中延伸到实物期权的估值——企业拥有的延迟投资、扩张或放弃项目的选择权，本质上都是期权。

---

## 思考题

1. 假设一只股票的波动率为 0（价格完全确定），此时一份平值（ATM）看涨期权的价值是多少？提示：考虑执行价格的现值。

2. 为什么深度实值（Deep ITM）的美式看涨期权可能在高股息股票的除息日前被提前行权？在什么条件下，持有者会选择提前行权而非继续持有？

3. 考虑一家生物科技公司，正在等待 FDA 对新药的审批结果。如果获批，公司价值翻倍；如果被拒，公司价值减半。这种情况适合用 Black-Scholes 模型估值吗？为什么？提示：考虑价格的连续性假设。

4. 权证的稀释效应会降低权证价值。但如果权证被行权，公司会收到现金。这笔现金能否完全抵消稀释效应？为什么？

5. 在实物期权的背景下，"执行价格"和"标的资产价值"分别对应什么？例如，对于一个尚未开发的油田，执行价格是什么？标的资产价值又是什么？

---

[^source]: 本文为教学化改写与总结，主要依据 Aswath Damodaran《Investment Valuation》Chapter 5: Option Pricing Theory and Models。
