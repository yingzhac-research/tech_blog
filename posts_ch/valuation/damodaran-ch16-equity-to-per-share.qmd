---
title: "【第16章】从股权价值到每股价值：估值的最后一公里"
description: "处理期权稀释、多类股份、交叉持股等复杂问题，正确计算每股内在价值"
author: "Ying"
date: "2025-12-16"
lang: zh
categories: [金融, 投资, 估值]
tags: [Valuation, Damodaran, 股权价值, 期权稀释, 每股价值]
format:
  html:
    toc: true
    toc-depth: 3
    number-sections: true
    html-math-method: mathjax
---

## 从一个问题开始

在前面的章节中，我们学会了如何计算股权价值——无论是通过 DDM、FCFE 还是 FCFF 模型。假设你刚刚完成了一个估值：

> 公司的股权价值 = 100 亿元

现在，你想知道这家公司的股票是否值得买入。你查到流通股数是 10 亿股，于是计算：

$$
\text{每股价值} = \frac{100 \text{ 亿}}{10 \text{ 亿股}} = 10 \text{ 元/股}
$$

当前股价是 8 元，看起来被低估了 25%，应该买入？

**且慢。**

你有没有考虑过：
- 公司有 1 亿份员工股票期权，行权价 5 元？
- 公司有一批可转换债券，可以转换成 5000 万股？
- 公司持有另一家上市公司 20% 的股权？
- 公司有 A 股和 B 股两类股份，投票权不同？

这些因素都会影响"每股价值"的计算。**从股权价值到每股价值，看似简单的除法，实际上充满陷阱。**

本章将系统地处理这些问题。

## 股份数量：看起来简单，实则复杂

### 三个不同的股份数量

在财务报告中，你可能看到三个不同的股份数量：

| 概念 | 定义 | 用途 |
|------|------|------|
| **已发行股份** (Shares Issued) | 公司曾经发行的全部股份 | 法律记录 |
| **流通股份** (Shares Outstanding) | 已发行 - 库存股 | 基本每股收益 |
| **完全稀释股份** (Fully Diluted) | 流通股 + 所有潜在股份 | 稀释每股收益 |

**为什么有差异？**

- **库存股**：公司回购后尚未注销的股份，不参与分红和投票
- **潜在股份**：期权、可转债、认股权证等可能转换为普通股的证券

::: {.callout-warning}
## 常见错误

在计算每股价值时，**绝对不能**简单使用流通股份数。必须考虑所有可能稀释股权的证券。

一个反面例子：2000 年代初的科技公司，流通股 1 亿，但员工期权可能高达 3000-5000 万份。忽略期权稀释会严重高估每股价值。
:::

### 基本股份数的确定

第一步是确定**当前的基本股份数**：

$$
\text{基本股份} = \text{已发行股份} - \text{库存股}
$$

这个数字可以在：
- 资产负债表的股东权益部分
- 季度/年度报告的注释
- 公司的投资者关系页面

找到。

## 期权与认股权证的处理

### 期权稀释的本质

员工股票期权（Employee Stock Options, ESOs）是最常见的稀释来源。理解期权稀释，需要先理解期权的本质：

**期权 = 以固定价格购买股票的权利**

如果期权行权价 < 股票市价，期权持有人会行权：
- 以低于市价的价格获得股票
- 稀释原有股东的权益

**关键问题**：期权持有人行权时支付的行权价，部分抵消了稀释效应。

### 库存股法（Treasury Stock Method）

这是处理期权稀释的标准方法。逻辑如下：

1. 假设所有价内期权（行权价 < 股价）都被行权
2. 公司收到行权价的现金
3. 假设公司用这些现金按市价回购股票
4. 净增加的股份 = 行权股份 - 回购股份

**公式：**

$$
\text{净增加股份} = N \times \left(1 - \frac{K}{S}\right) = N \times \frac{S - K}{S}
$$

其中：
- $N$ = 期权数量
- $K$ = 行权价
- $S$ = 当前股价（或估值得到的每股价值）

**直觉理解**：

如果股价 20 元，行权价 10 元，100 万份期权：
- 行权后增加 100 万股
- 公司收到 1000 万元现金
- 用这 1000 万按 20 元回购 50 万股
- 净稀释 = 100 - 50 = 50 万股

用公式验证：
$$
100 \times \frac{20 - 10}{20} = 100 \times 0.5 = 50 \text{ 万股}
$$

### 库存股法的问题

库存股法简单易用，但有几个问题：

**问题 1：忽略期权的时间价值**

库存股法只考虑期权的内在价值（$S - K$），完全忽略了时间价值。一份还有 5 年到期的期权，即使现在是价外的（$K > S$），也有价值。

**问题 2：循环引用**

注意公式中需要用到 $S$（股价）。但如果我们正在估值，$S$ 正是我们要计算的结果！

**问题 3：处理价外期权**

按库存股法，价外期权（$K > S$）不产生稀释。但这些期权未来可能变成价内的。

### 更精确的方法：期权定价法

为了解决上述问题，我们可以用期权定价模型（如 Black-Scholes）直接计算期权的价值：

$$
\text{期权总价值} = \sum_{i} N_i \times \text{BS}(S, K_i, T_i, r, \sigma)
$$

然后从股权价值中扣除：

$$
\text{普通股股权价值} = \text{总股权价值} - \text{期权价值}
$$

$$
\text{每股价值} = \frac{\text{普通股股权价值}}{\text{基本流通股数}}
$$

**这种方法的优势：**
- 正确处理期权的时间价值
- 可以处理价外期权
- 避免循环引用问题

::: {.callout-tip}
## 实践建议

对于期权数量较大的公司（科技公司常见），建议使用期权定价法。对于期权数量较小的传统公司，库存股法通常足够准确。

判断标准：如果期权/流通股 > 5%，应该使用更精确的方法。
:::

### 期权处理的完整案例

**案例：TechCorp 期权稀释分析**

已知信息：
- 估算的股权价值：50 亿元
- 基本流通股：5 亿股
- 未行权期权：6000 万份
  - 2000 万份，行权价 6 元，剩余期限 2 年
  - 2500 万份，行权价 8 元，剩余期限 3 年
  - 1500 万份，行权价 12 元，剩余期限 4 年
- 无风险利率：3%
- 股价波动率：40%

**方法一：库存股法**

假设初始每股价值 = 50/5 = 10 元

| 期权批次 | 数量 | 行权价 | 价内？ | 净稀释 |
|----------|------|--------|--------|--------|
| 批次 1 | 2000万 | 6 元 | 是 | 2000×(10-6)/10 = 800万 |
| 批次 2 | 2500万 | 8 元 | 是 | 2500×(10-8)/10 = 500万 |
| 批次 3 | 1500万 | 12 元 | 否 | 0 |
| **合计** | | | | **1300万股** |

调整后每股价值：
$$
\frac{50 \text{ 亿}}{5 \text{ 亿} + 0.13 \text{ 亿}} = \frac{50}{5.13} = 9.75 \text{ 元}
$$

但等等——我们用 10 元计算稀释，结果得到 9.75 元。需要**迭代**！

第二轮：用 9.75 元重新计算稀释...

最终收敛到约 **9.72 元/股**。

**方法二：期权定价法**

使用 Black-Scholes 模型（假设股价 = 10 元）：

| 期权批次 | 数量 | 行权价 | 期限 | BS价值/份 | 总价值 |
|----------|------|--------|------|-----------|--------|
| 批次 1 | 2000万 | 6 元 | 2年 | 4.52 元 | 0.90亿 |
| 批次 2 | 2500万 | 8 元 | 3年 | 3.68 元 | 0.92亿 |
| 批次 3 | 1500万 | 12 元 | 4年 | 2.41 元 | 0.36亿 |
| **合计** | | | | | **2.18亿** |

调整后股权价值：
$$
\text{普通股股权价值} = 50 - 2.18 = 47.82 \text{ 亿}
$$

每股价值：
$$
\frac{47.82}{5} = 9.56 \text{ 元}
$$

**两种方法的比较：**

| 方法 | 每股价值 | 差异 |
|------|----------|------|
| 库存股法 | 9.72 元 | - |
| 期权定价法 | 9.56 元 | -1.6% |

差异来源：期权定价法正确处理了价外期权（批次 3）的时间价值。

## 可转换证券的处理

### 可转换债券

可转换债券（Convertible Bonds）给持有人一个选择权：
- 继续持有债券，获得利息和本金
- 转换为普通股

**处理方法取决于估值视角：**

**方法一：在 FCFF 模型中**

如果可转债被视为"类股权"：
1. 将可转债视为股权的一部分
2. 不在债务中扣除
3. 在计算每股价值时，加入转换后的股份

**方法二：分拆处理**

将可转债分拆为：
- 纯债券部分（按普通债券定价）
- 转换期权部分（按期权定价）

$$
\text{可转债价值} = \text{纯债券价值} + \text{转换期权价值}
$$

**案例：可转债稀释**

公司发行了 10 亿元可转债：
- 票面利率：2%
- 转换价格：25 元/股
- 剩余期限：5 年
- 当前估值的每股价值：30 元

转换后增加股数：
$$
\frac{10 \text{ 亿}}{25 \text{ 元}} = 0.4 \text{ 亿股}
$$

由于 30 > 25，持有人有转换动机。应该假设全部转换。

**但注意**：如果转换，公司不再需要支付这笔债务。所以正确的处理是：

$$
\text{调整后股权价值} = \text{原股权价值} + \text{可转债面值}
$$

$$
\text{调整后股数} = \text{原股数} + \text{转换股数}
$$

### 优先股

优先股是股权和债务的混合体。处理方法：

**情况 1：不可转换优先股**

视为债务，从企业价值中扣除（在 FCFF 模型中）：

$$
\text{普通股权价值} = \text{企业价值} - \text{债务} - \text{优先股}
$$

**情况 2：可转换优先股**

类似可转换债券，需要考虑转换可能性。

### 认股权证（Warrants）

认股权证类似于期权，但有几个区别：

| 特征 | 员工期权 | 认股权证 |
|------|----------|----------|
| 发行者 | 公司内部 | 公司对外 |
| 持有人 | 员工 | 外部投资者 |
| 期限 | 通常较短（5-10年） | 可以更长 |
| 行权时 | 发行新股 | 发行新股 |

处理方法与期权相同，可以使用库存股法或期权定价法。

## 多类股份的处理

### 为什么会有多类股份？

很多公司有不同类别的股份，通常区别在于投票权：

| 公司 | 股份类别 | 投票权差异 |
|------|----------|------------|
| Google (Alphabet) | A类、B类、C类 | 1:10:0 |
| Facebook (Meta) | A类、B类 | 1:10 |
| Berkshire Hathaway | A类、B类 | 1:1/10000 |

**为什么这样设计？**

通常是为了让创始人在融资稀释后仍保持控制权。扎克伯格持有 Meta 约 13% 的股份，但控制超过 50% 的投票权。

### 估值时如何处理？

**方法一：忽略投票权差异**

假设两类股份的经济权利相同，按总股本计算每股价值。

这种方法简单，但忽略了控制权溢价/折价。

**方法二：分别估值**

1. 估算整体股权价值
2. 根据经济权利分配给各类股份
3. 考虑投票权溢价/折价调整

**控制权溢价**

研究表明，高投票权股份通常有溢价：

| 市场 | 平均投票权溢价 |
|------|----------------|
| 美国 | 5-10% |
| 欧洲 | 10-20% |
| 新兴市场 | 20-50% |

**实践建议**：如果分析的是高投票权股份，可以适当上调估值；如果是低投票权股份，适当下调。

## 交叉持股与子公司的处理

### 上市子公司

如果被估值公司持有另一家上市公司的股权，有两种处理方式：

**方法一：合并估值**

将子公司的现金流合并到母公司的现金流中，一起折现。

**方法二：分部加总（Sum of Parts）**

$$
\text{母公司价值} = \text{核心业务价值} + \text{持股市值}
$$

**方法二的优势**：
- 更透明，便于分析各部分价值
- 可以利用子公司的市场价格

**方法二的注意事项**：
- 控股溢价：如果持股比例高，可能有控制权溢价
- 流动性折价：如果持股比例低，可能需要打折

### 少数股东权益

如果使用 FCFF 模型估值一家有非全资子公司的公司：

1. **FCFF 包含了子公司 100% 的现金流**（合并报表）
2. **企业价值也对应 100% 的子公司价值**
3. **但母公司只拥有部分权益**

因此，在计算股权价值时：

$$
\text{股权价值} = \text{企业价值} - \text{债务} - \text{少数股东权益}
$$

::: {.callout-note}
## 少数股东权益的价值

理论上，少数股东权益应该按公允价值计量。实践中：
- 如果子公司上市，可以用市场价格
- 如果子公司未上市，可以用账面价值作为近似

对于少数股东权益占比很大的公司，建议使用分部加总法，分别估值各子公司。
:::

### 交叉持股

交叉持股是指两家公司相互持有对方股份。这在日本和韩国的财阀集团中很常见。

**问题**：A 持有 B 的股份，B 持有 A 的股份，形成循环。

**解决方法**：建立联立方程

假设：
- A 公司核心业务价值 = $V_A^{core}$
- B 公司核心业务价值 = $V_B^{core}$
- A 持有 B 的比例 = $\alpha$
- B 持有 A 的比例 = $\beta$

则：
$$
V_A = V_A^{core} + \alpha \times V_B
$$
$$
V_B = V_B^{core} + \beta \times V_A
$$

解这个方程组：
$$
V_A = \frac{V_A^{core} + \alpha \times V_B^{core}}{1 - \alpha \beta}
$$

## 现金与非经营性资产

### 现金的处理

公司持有的现金应该如何处理？

**在 FCFF 模型中：**

$$
\text{股权价值} = \text{经营性资产的企业价值} - \text{债务} + \text{现金}
$$

**为什么加回现金？**

因为 FCFF 衡量的是经营产生的现金流，不包括现金投资的收益。现金是一项独立的资产，应该单独加回。

**但要注意：**

1. **现金可能打折**
   - 有些公司的现金可能被用于低效投资
   - 现金放在海外可能有税务成本（汇回需要缴税）

2. **受限现金**
   - 抵押存款、保证金等不能自由使用
   - 应该从"现金"中扣除

3. **最低经营现金**
   - 公司需要保持一定现金来维持日常运营
   - 这部分现金不是"自由"的

**实践建议**：

$$
\text{可加回现金} = \text{总现金} - \text{受限现金} - \text{最低经营现金}
$$

最低经营现金通常估计为收入的 2-5%。

### 其他非经营性资产

| 资产类型 | 处理方法 |
|----------|----------|
| 上市证券投资 | 按市值加回 |
| 非上市股权投资 | 按账面价值或估算公允价值 |
| 闲置房地产 | 按市场价值估算 |
| 税务资产（NOL） | 折现后加回 |

## 每股价值计算的完整流程

让我们把所有内容整合成一个完整的流程：

### 第一步：确定基本股份数

$$
\text{基本股份} = \text{已发行股份} - \text{库存股}
$$

### 第二步：计算期权的影响

**选项 A：库存股法**
$$
\text{稀释股数} = \sum_i N_i \times \max\left(0, \frac{S - K_i}{S}\right)
$$

**选项 B：期权定价法**
$$
\text{期权价值} = \sum_i N_i \times \text{BS}(S, K_i, T_i, r, \sigma)
$$

### 第三步：处理可转换证券

- 可转换债券：如果 转换价格 < 股价，假设转换
- 优先股：从股权价值中扣除，或假设转换
- 认股权证：同期权处理

### 第四步：调整非经营性资产

$$
\text{调整后股权价值} = \text{经营性股权价值} + \text{现金} + \text{其他非经营资产}
$$

### 第五步：扣除其他索取权

$$
\text{普通股股权价值} = \text{调整后股权价值} - \text{期权价值} - \text{优先股} - \text{少数股东权益}
$$

### 第六步：计算每股价值

**如果用库存股法：**
$$
\text{每股价值} = \frac{\text{普通股股权价值}}{\text{基本股份} + \text{稀释股数}}
$$

**如果用期权定价法：**
$$
\text{每股价值} = \frac{\text{普通股股权价值}}{\text{基本股份}}
$$

## 完整案例：从企业价值到每股价值

### 案例背景

我们来估值一家公司 GlobalTech：

**估值结果：**
- 经营性资产的企业价值（FCFF 折现）：200 亿元

**资本结构：**
- 长期债务：30 亿元
- 可转换债券：10 亿元（转换价格 15 元/股）
- 优先股：5 亿元
- 少数股东权益：8 亿元
- 现金及等价物：25 亿元（其中受限现金 2 亿）

**股权结构：**
- A 类股份：8 亿股（1股1票）
- B 类股份：2 亿股（1股10票）
- 库存股：0.5 亿股（全部为 A 类）

**期权：**
- 5000 万份期权，平均行权价 12 元
- 平均剩余期限 3 年

**其他：**
- 持有上市公司 XYZ 的 15% 股权，市值 6 亿元
- 股价波动率：35%
- 无风险利率：3%

### 计算过程

**第一步：计算基本股份**

$$
\text{基本股份} = (8 - 0.5) + 2 = 9.5 \text{ 亿股}
$$

**第二步：计算普通股股权价值**

$$
\text{股权价值} = 200 - 30 + (25 - 2) + 6 - 8 = 191 \text{ 亿元}
$$

（暂不扣除可转换债券和期权，稍后处理）

**第三步：处理可转换债券**

初步每股价值估计：$191/9.5 = 20.1$ 元

由于 20.1 > 15（转换价格），假设可转债持有人会转换。

转换股数：$10 \text{ 亿} / 15 = 0.67 \text{ 亿股}$

调整：
- 股权价值加回可转债面值：$191 + 10 = 201$ 亿元
- 股份增加：$9.5 + 0.67 = 10.17$ 亿股

**第四步：处理期权**

使用期权定价法（假设当前股价 ≈ 20 元）：

用 Black-Scholes 计算每份期权价值：
- $S = 20$, $K = 12$, $T = 3$, $r = 3\%$, $\sigma = 35\%$
- $d_1 = 1.12$, $d_2 = 0.51$
- 期权价值 ≈ 9.5 元/份

期权总价值：$0.5 \text{ 亿} \times 9.5 = 4.75 \text{ 亿元}$

**第五步：扣除优先股和期权价值**

$$
\text{普通股股权价值} = 201 - 5 - 4.75 = 191.25 \text{ 亿元}
$$

**第六步：计算每股价值**

$$
\text{每股价值} = \frac{191.25}{10.17} = 18.81 \text{ 元}
$$

### 敏感性分析

如果不考虑期权稀释：
$$
\text{每股价值} = \frac{196}{10.17} = 19.27 \text{ 元}
$$

差异：2.4%

如果不考虑可转债转换：
$$
\text{每股价值} = \frac{186.25}{9.5} = 19.61 \text{ 元}
$$

差异：4.2%

这个案例说明，正确处理稀释性证券可能导致 5% 以上的估值差异。

## 常见错误与陷阱

### 错误一：使用财报上的股份数

财报上的"加权平均股数"是会计概念，用于计算 EPS。估值时应该使用**期末实际流通股数**，并考虑稀释。

### 错误二：双重计算期权

如果用期权定价法扣除了期权价值，就**不应该**再增加稀释股数。两种方法只能选一种。

### 错误三：忽略价外期权

库存股法忽略价外期权，但这些期权仍有时间价值。对于期权比例高、期限长的公司，这会导致高估。

### 错误四：现金全额加回

不是所有现金都是"自由"的：
- 经营所需的最低现金
- 受限现金
- 海外现金（可能有税务成本）

### 错误五：忽略控制权差异

对于多类股份的公司，高投票权和低投票权股份的价值是不同的。需要根据分析目的进行调整。

## 总结

::: {.callout-important}
## 核心要点

- **股份数不只是简单的数字**：需要考虑库存股、期权、可转债等多种因素
- **期权稀释有两种处理方法**：库存股法简单但不精确，期权定价法更准确但计算复杂
- **可转换证券要判断转换可能性**：价内时应假设转换
- **非经营性资产单独处理**：现金、投资等应加回到股权价值
- **从企业价值到每股价值是多步骤过程**：扣除债务、优先股、少数股东权益，处理稀释
- **多类股份需要考虑控制权差异**：高投票权股份通常有溢价
:::

本章我们回答了开头的问题：从股权价值到每股价值，**绝不是简单的除法**。正确处理期权、可转债、多类股份等因素，是得出准确每股内在价值的关键。

关键的 takeaway 是：**估值的"最后一公里"往往被忽视，但可能导致 5-10% 甚至更大的估值误差。细节决定成败。**

## 思考题

1. **库存股法的循环问题**：库存股法需要知道股价来计算稀释股数，但股价正是我们要估算的。如何解决这个循环？除了迭代，还有其他方法吗？

2. **期权的激励效应**：员工期权不仅是稀释，也是激励。你认为在估值时，应该只考虑稀释，还是也应该考虑期权带来的正面激励效应？

3. **可转债的信号**：一家公司大量使用可转债融资而非普通债务或股权。这传递了什么信号？对估值有何影响？

4. **控制权折价**：如果你分析的是一家公司的低投票权股份（如 Google 的 C 类），你会给多大的折价？折价应该取决于什么因素？

5. **复杂股权结构的简化**：面对一家有多种可转换证券、多类股份、交叉持股的公司，你会如何简化分析？什么时候简化是可以接受的？
