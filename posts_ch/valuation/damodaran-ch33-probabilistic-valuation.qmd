---
title: "【第33章】概率估值方法：情景分析、决策树与蒙特卡洛模拟"
description: "传统DCF只给出一个点估计值，但风险资产的价值可能有数百种结果。本章探讨三种概率方法——情景分析、决策树和蒙特卡洛模拟——如何帮助我们理解价值的完整分布，以及如何避免风险的双重计数陷阱。"
author: "Ying"
date: "2026-01-02"
lang: zh
categories: [金融, 投资, 估值]
tags: [Valuation, Damodaran, 情景分析, 决策树, 蒙特卡洛模拟, 风险管理]
format:
  html:
    toc: true
    toc-depth: 3
    number-sections: true
    html-math-method: mathjax
---

## 从一个问题开始

在本书的大部分章节中，我们使用 DCF 模型给出一个**点估计值**——"这家公司值 $50 亿"。但这个数字隐藏了一个关键问题：

> **我们有多大把握这个估值是对的？**

传统方法将风险浓缩为一个数字：更高的折现率、更低的现金流、或者对价值的折扣。但这种做法有几个局限：

1. **模糊了风险的本质**：折现率是一个"钝器"，无法区分不同类型的风险
2. **忽略了结果的分布**：一家公司可能在最好情况下值 $100 亿，在最坏情况下值 $10 亿——这种信息在点估计中完全消失了
3. **无法处理离散风险**：某些风险是"全有或全无"的——药品获批或被拒、公司被国有化或不被国有化——折现率无法捕捉这种二元性

本章将探讨三种**概率估值方法（Probabilistic Approaches）**，它们不只给出期望值，还能揭示价值的完整分布：

| 方法 | 核心思想 | 最适合的风险类型 |
|------|----------|-----------------|
| **情景分析** | 在几个关键情景下估值 | 离散、同时发生、相关的风险 |
| **决策树** | 将风险分解为阶段，追踪最优决策 | 离散、顺序发生、独立的风险 |
| **蒙特卡洛模拟** | 从概率分布中抽样，运行数千次估值 | 连续风险，需要完整分布 |

`★ Insight ─────────────────────────────────────`

**Damodaran 的核心洞察**：

概率方法不是 DCF 的替代品，而是**补充**。它们帮助我们理解：
- 价值的**范围**而非单一数字
- 哪些**输入变量**对价值影响最大
- 在不同情景下应该采取什么**行动**

但要注意：这些方法容易导致**风险的双重计数**——在折现率中计入风险，又在模拟结果中惩罚高波动性。

`─────────────────────────────────────────────────`

---

## 情景分析（Scenario Analysis）

### 为什么需要情景分析？

我们用来估值的"预期现金流"可以通过两种方式估计：

1. **概率加权平均**：考虑所有可能情景，用概率加权
2. **最可能情景**：只用最可能发生的那个情景

前者更精确，但很少使用——因为需要太多信息。后者更常见，但遗漏了其他情景的信息。

**情景分析**提供了一个中间路径：在**几个关键情景**下估计现金流和价值，帮助我们理解风险对价值的影响。

### 最佳/最差情景分析

最简单的情景分析只考虑三个情景：

- **最佳情景（Best Case）**：一切顺利
- **最可能情景（Most Likely Case）**：基准情况
- **最差情景（Worst Case）**：一切出问题

**两种构建方法**：

| 方法 | 做法 | 问题 |
|------|------|------|
| **极端输入法** | 每个输入设为最佳/最差值 | 可能**不可行**——高增长可能需要低价格 |
| **可行组合法** | 在输入之间的关系约束下，找到最大/最小价值 | 更**现实**，但需要更多工作 |

**最佳/最差分析的价值**：

1. **风险度量**：价值范围（scaled to size）越大，风险越高
2. **下行风险评估**：帮助投资者了解最坏情况的影响

**但总体而言，最佳/最差分析信息量有限**。知道一只股票在最好情况下值 $80、最差情况下值 $10，并不能帮助你判断 $50 的市价是否合理。

### 多情景分析

情景分析不必局限于三个情景。在更一般的形式中，我们可以在**多个情景**下估值，变化宏观经济和公司特定变量的假设。

**情景分析的四个步骤**：

**步骤1：确定关键因素**

情景应该围绕**2-3个最关键的因素**构建：

| 公司类型 | 关键因素示例 |
|----------|-------------|
| 汽车公司考虑新工厂 | 经济状况 |
| 消费品公司推出新产品 | 竞争对手反应 |
| 受监管公司推出新服务 | 监管部门态度 |

**步骤2：确定每个因素的情景数量**

更多情景更现实，但也更难：
- 收集信息更困难
- 区分情景之间的现金流差异更难
- 5个情景比15个情景更容易操作

**步骤3：估计每个情景下的现金流、折现率和价值**

这是情景分析最耗时的部分。这也是为什么步骤1和2要聚焦于少数关键因素。

**步骤4：分配概率**

对于宏观经济因素（汇率、利率、经济增长），可以借助专业预测服务。对于行业或竞争因素，需要依靠你自己的行业知识。

::: {.callout-note}
## 定量 vs 定性视角

定量分析师将情景分析视为计算期望值的工具。但战略家们有不同看法：情景分析的主要价值是**拓宽决策者的思维**——思考"合理的未来叙事"而非"最可能的结果"。

即使某些情景发生的概率很低，考虑它们的价值在于：**迫使你思考与基准情况不同的可能性**。
:::

### Illustration 33.1：国有化风险下的委内瑞拉公司估值

某些风险很难通过折现率来处理。**国有化风险**就是一个典型例子——它是离散的、全有或全无的。

假设你正在估值一家委内瑞拉公司：

| 参数 | 值 |
|------|-----|
| 明年税后营业收入 | $1,000 万（美元计） |
| 永续增长率 | 3% |
| 资本回报率 | 20%（投入资本 $5,000 万） |
| 资本成本 | 12%（含国家宏观风险，不含国有化风险） |

**情景1：持续经营（Going Concern）**

$$
\text{再投资率} = \frac{g}{\text{ROC}} = \frac{3\%}{20\%} = 15\%
$$

$$
\text{经营资产价值} = \frac{\text{EBIT}(1-t)(1 - \frac{g}{\text{ROC}})}{k_c - g} = \frac{\$10M \times (1 - 0.15)}{0.12 - 0.03} = \$94.44M
$$

**情景2：国有化**

假设国有化后，政府只支付账面价值作为补偿：

$$
\text{国有化价值} = \text{账面价值} = \$50M
$$

**概率加权期望值**（假设国有化概率25%）：

$$
\begin{aligned}
\text{期望价值} &= \text{持续经营价值} \times (1 - P_{\text{国有化}}) + \text{国有化价值} \times P_{\text{国有化}} \\
&= \$94.44M \times 0.75 + \$50M \times 0.25 \\
&= \$83.33M
\end{aligned}
$$

**关键洞察**：国有化概率越高、补偿越低，期望价值越低。这种信息无法通过简单调整折现率来捕捉。

---

### Illustration 33.2：监管风险下的 Wells Fargo 估值（2009年）

让我们看一个更复杂的多情景分析案例。2009年初，在金融危机之后估值 Wells Fargo 面临巨大的不确定性：

**历史数据（2001-2008）**：

| 年份 | 净利润 | 账面股权 | ROE | 股息支付率 |
|------|--------|----------|-----|-----------|
| 2007 | $80.57 亿 | $458.76 亿 | 17.56% | 49.09% |
| 2008 | $28.42 亿 | $476.28 亿 | 5.97% | 202.36% |
| 01-07 平均 | - | - | 18.91% | 43.73% |

2008年是灾难性的一年——净利润暴跌65%，ROE 从18%降到6%。面对这种情况，分析师需要回答：

1. **基期数据用什么？** 2008是异常值，还是新常态的开始？
2. **Beta 用多少？** 银行历史 Beta 约为1，但危机揭示了隐藏风险

**三情景框架**：

| 情景 | 概率 | ROE | 股权成本 | 假设 |
|------|------|-----|----------|------|
| 快速恢复 | 10% | 18.91% | 9% | 危机很快过去，监管不变 |
| 缓慢恢复 | 60% | 15.00% | 10% | 危机缓慢消退，监管资本要求提高 |
| 新世界秩序 | 30% | 12.00% | 11% | 危机持续，监管大幅收紧 |

**估值公式**（稳定增长3%）：

$$
\text{股权价值} = \frac{\text{账面股权} \times \text{ROE} \times (1 - \frac{g}{\text{ROE}})}{k_e - g}
$$

**各情景估值**（使用账面股权 $476.28 亿）：

| 情景 | 净利润 | 股权价值 |
|------|--------|----------|
| 快速恢复 | $90.06 亿 | $1,262.94 亿 |
| 缓慢恢复 | $71.44 亿 | $816.48 亿 |
| 新世界秩序 | $57.15 亿 | $535.82 亿 |

**期望价值**：

$$
E(\text{股权}) = 0.10 \times \$1262.94 + 0.60 \times \$816.48 + 0.30 \times \$535.82 = \$776.93 \text{亿}
$$

当时 Wells Fargo 的市值约为 $666 亿。**按期望值计算，股票被低估了约16%**。但估值对情景概率非常敏感——如果"新世界秩序"的概率更高，股票可能是高估的。

---

### 情景分析的价值与局限

**价值**：

1. **风险可视化**：价值范围反映了资产的风险程度
2. **敏感性识别**：发现哪些输入对价值影响最大
3. **对冲指导**：如果某些情景下价值大幅下降，可以考虑对冲

**局限**：

| 问题 | 说明 |
|------|------|
| **垃圾进，垃圾出** | 情景必须**现实**且**覆盖可能性全谱** |
| **连续风险** | 情景分析最适合离散风险；连续风险需要划分为离散类别 |
| **风险双重计数** | 可能在折现率中计入风险，又因为某些情景价值低而拒绝投资 |

::: {.callout-warning}
## 常见错误：基于情景拒绝投资

假设一只股票：
- 期望价值：$50（风险调整后）
- 市价：$40
- 最差情景价值：$20

分析师可能因为最差情景下"大幅高估"而拒绝买入。但这是**双重计数风险**——期望价值已经是风险调整后的，不应该再因为某些情景价值低而惩罚。
:::

---

## 决策树（Decision Trees）

### 为什么需要决策树？

有些风险不只是离散的，而且是**顺序的（Sequential）**。资产要有价值，必须通过一系列测试，任何一个阶段失败都可能导致完全损失。

**典型例子：FDA 药品审批流程**

```
临床前 → Phase 1 → Phase 2 → Phase 3 → 审批 → 商业化
         (安全性)   (有效性)   (长期效果)
```

每个阶段都可能失败。对于大型制药公司，这种风险可以在药品组合中平均化，使用传统 DCF。但对于只有一个药品的小型生物技术公司，**整个公司的价值取决于这个顺序风险过程**。

决策树允许我们：
1. 分阶段考虑风险
2. 在每个阶段根据结果制定最优决策

### 决策树的四种节点

理解决策树首先要区分四种节点：

| 节点类型 | 符号 | 含义 |
|----------|------|------|
| **根节点（Root Node）** | - | 起点，可能是决策或不确定事件 |
| **事件节点（Event Node）** | ○ | 不确定结果，需要估计概率 |
| **决策节点（Decision Node）** | □ | 决策者的选择 |
| **终节点（End Node）** | ◁ | 最终结果 |

**简单示例**：你可以选择确定的 $20，或者参与一个赌博（50%概率赢 $50，50%概率赢 $10）。

```
                    赢大
                  / $50
                 /  50%
        赌博 ○ ─
      / $30    \
     /          \ 50%
□ ─             赢小
     \           $10
      \
       确定金额
         $20
```

期望值计算：赌博的期望值 = 0.5 × $50 + 0.5 × $10 = $30 > $20，所以应该选择赌博。

### 决策树分析的五个步骤

**步骤1：将风险分解为阶段**

关键是识别未来会面临的风险阶段。有时这很容易（如 FDA 审批只有通过/不通过），有时需要将连续结果划分为离散类别（如市场测试结果分为"大成功"、"一般"、"失败"）。

**步骤2：估计每个阶段的结果概率**

概率需要满足：
- 每个阶段的概率之和 = 1
- 考虑**条件概率**：一个阶段的结果可能影响下一阶段的概率

**步骤3：定义决策点**

在决策树中嵌入决策点：根据前一阶段的结果和对未来的预期，决定最优行动。例如：
- 市场测试失败后：放弃 vs 继续 vs 做第二次测试？

**步骤4：计算终节点的现金流/价值**

- 有些终节点容易计算（如放弃 = 已花费的成本）
- 有些需要完整的 DCF（如全国推广 = 产品生命周期内现金流的现值）

**步骤5："折叠"决策树**

从终节点开始，**逆向计算期望值**：
- **事件节点**：概率加权平均
- **决策节点**：选择期望值最高的分支

最终得到今天的期望价值。

---

### Illustration 33.3：生物技术公司决策树估值

让我们估值一家只有一个产品的小型生物技术公司——一种治疗 I 型糖尿病的药物，即将进入 FDA Phase 1。

**Phase 信息**：

| 阶段 | 成本 | 时间 | 成功概率 | 备注 |
|------|------|------|----------|------|
| Phase 1 | $5,000 万 | 1年 | 70% | 100名志愿者，测试安全性和剂量 |
| Phase 2 | $1 亿 | 2年 | 见下方 | 250名志愿者，测试有效性 |
| Phase 3 | $2.5-3 亿 | 4年 | 75-80% | 4,000名志愿者，测试长期效果 |

**Phase 2 结果的条件概率**：

| 结果 | 概率 | 后续 |
|------|------|------|
| 仅对 I 型有效 | 30% | Phase 3 成本 $2.5 亿，成功率 80% |
| 仅对 II 型有效 | 10% | Phase 3 成本 $2.5 亿，成功率 80% |
| 对 I 型和 II 型都有效 | 10% | Phase 3 成本 $3 亿，成功率 75% |
| 失败 | 50% | 放弃 |

**商业化参数**（通过 Phase 3 后）：

| 适应症 | 开发成本 | 年现金流 | 年限 |
|--------|----------|----------|------|
| 仅 I 型 | $5 亿 | $3 亿 | 15年 |
| 仅 II 型 | $5 亿 | $1.25 亿 | 15年 |
| I 型 + II 型 | $6 亿 | $4 亿 | 15年 |

**资本成本**：10%

**决策树结构**：

```
Year 1          Years 2-3       Years 4-7        Years 8-22

                              成功 ─ 开发 → $400M×PVA(10%,15y)
                             / 75%    -$600M
              I+II型 ○──────
             / 10%  -$300M  \ 失败 → 放弃
            /                 25%
成功 ○────── II型 ○──成功 80% → 开发 → $125M×PVA
 70%       | 10% -$250M  失败 20% → 放弃
-$100M     |
           | I型 ○──成功 80% → 开发 → $300M×PVA
测试       | 30% -$250M  失败 20% → 放弃
○─$50M     |
           \ 失败 50%
            \
             → 放弃

失败 30% → 放弃
```

**终节点现值计算**（以 I 型 + II 型为例，假设成功）：

首先计算15年年金的现值因子：

$$
\text{PVA}(10\%, 15年) = \frac{1 - (1.1)^{-15}}{0.10} = 7.606
$$

开发成功后的价值（第7年末）：

$$
\text{PV}_7 = -\$600M + \$400M \times 7.606 = \$2,442.4M
$$

折现到今天：

$$
\text{PV}_0 = \frac{-\$50M}{1.1^0} + \frac{-\$100M}{1.1^1} + \frac{-\$300M}{1.1^3} + \frac{\$2,442.4M}{1.1^7}
$$

$$
= -\$50M - \$90.91M - \$225.39M + \$1,253.35M = \$887.05M
$$

**决策树折叠计算**：

从终节点逆向计算：

1. **I 型 + II 型路径**：
   - Phase 3 后决策：开发（$887.05M）vs 放弃（−$366.30M）→ 选择开发
   - Phase 3 前期望值：0.75 × $887.05M + 0.25 × (−$366.30M) = $573.71M

2. **仅 II 型路径**（有趣的情况）：
   - 开发后 PV = −$97.43M
   - 放弃 PV = −$328.74M
   - **虽然开发是负值，但仍应开发**——因为放弃更差！

   这是因为到那时，Phase 1-3 的成本已经是**沉没成本**。从第7年看：

   $$
   \text{边际PV} = -\$500M + \$125M \times 7.606 = +\$450.75M > 0
   $$

3. **汇总期望值**：

$$
\text{公司价值} = \$50.36M
$$

::: {.callout-important}
## 决策树的两个关键输出

1. **今天的期望价值**：$50.36M，反映了所有可能路径的概率加权
2. **价值范围**：从 −$366.30M（Phase 3 失败，I+II型）到 +$887.05M（成功开发 I+II型）

后者揭示了**这家公司的风险有多大**——价值可能完全归零，也可能翻10倍以上。
:::

---

### 决策树在决策中的价值

**动态风险响应**：决策树迫使你思考"如果...那么..."——不管哪种结果出现，你都有准备好的行动计划。

**信息价值**：决策树帮助你评估获取更多信息的价值。例如：市场测试的成本 vs 它提供的关于成功概率的改进信息。

**风险管理**：决策树展示了现金流如何随时间展开，帮助你决定应该对冲哪些风险。

### 决策树的局限

| 局限 | 说明 |
|------|------|
| **适合顺序风险** | 同时发生的风险难以在决策树中建模 |
| **需要离散结果** | 连续结果需要划分为类别 |
| **概率估计困难** | 需要估计每个阶段的成功概率 |
| **依赖纪律** | 期望值基于你会在决策点做出最优选择的假设 |

### 决策树与风险调整价值

一个常见的误解是：决策树因为考虑了好坏结果的概率，所以已经是风险调整的，应该用**无风险利率**折现。

**这通常是错误的。**

概率加权的期望值**不是**风险调整值。唯一可以用无风险利率的情况是：不确定结果中的风险是**资产特定的、可分散的**。

例如，在药品审批例子中：
- **前7年**（审批阶段）：风险主要是审批风险——这是资产特定的，可能可分散。可以考虑用接近无风险利率折现
- **第7年后**（商业化阶段）：风险包含市场风险——不可分散，必须用风险调整利率

**避免双重计数的关键**：

如果折现率已经反映了失败风险（如风险投资的目标回报率），那么在决策树中再次用概率调整就是双重计数。

$$
\text{估计价值} = \$89.20M = \frac{\$400M}{1.35^5}
$$

35%的目标回报率**已经内嵌了失败概率**。如果你用正确的业务折现率（如15%）并显式建模失败概率：

$$
\$89.20M = \frac{\$400M}{1.15^5} \times p \implies p = 44.85\%
$$

用35%在决策树中折现会**低估**投资价值。

---

## 蒙特卡洛模拟（Monte Carlo Simulation）

### 为什么需要模拟？

情景分析和决策树处理**离散风险**。但大多数真实风险是**连续的**——可能产生数百甚至数千种结果。

模拟的核心思想：
1. 为每个输入变量定义**概率分布**（而非点估计）
2. 从每个分布中**随机抽样**，得到一组输入
3. 用这组输入计算价值
4. 重复**数千次**
5. 得到价值的**完整分布**

### 模拟的四个步骤

**步骤1：确定概率变量**

理论上可以为每个输入定义分布。但实际上应该聚焦于**对价值影响最大的几个变量**。

**步骤2：定义概率分布**

这是最困难也最关键的一步。有三种方法：

**方法1：历史数据**

如果变量有长期可靠的历史数据，可以直接用历史分布：

```
例：美国10年期国债利率的年度变化（1928-2023）
- 可以用历史频率作为未来变化的概率分布
- 隐含假设：没有结构性变化使历史数据失效
```

**方法2：横截面数据**

如果缺乏历史数据，可以用同类公司的当前差异：

```
例：估值一家服装公司的营业利润率
- 可以用所有服装公司当前利润率的分布
- 隐含假设：你的公司和行业中其他公司有相同的利润率分布
```

**方法3：统计分布+参数**

如果历史和横截面数据都不足，需要选择分布类型并估计参数：

| 分布类型 | 特征 | 适用场景 |
|----------|------|----------|
| **正态分布** | 对称、钟形 | 收入增长率（但不能 < -100%） |
| **均匀分布** | 区间内等概率 | 利润率（已知上下限） |
| **对数正态** | 右偏、非负 | 资产价格、倍数 |
| **三角分布** | 有最小、最可能、最大值 | 专家估计 |

::: {.callout-warning}
## 常见问题

1. **分布不匹配**：真实数据很少完美符合理论分布。选择"足够接近"的分布
2. **参数估计**：即使选对了分布，仍需估计参数（均值、标准差等）
:::

**步骤3：检查变量间的相关性**

变量之间可能存在相关性：

- 利率↑ 通常伴随 通胀↑
- 收入↑ 可能伴随 利润率↓（需要降价促销）

处理方法：
1. **创建复合变量**：如用"实际利率"（名义利率 - 通胀）代替两个变量
2. **显式建模相关性**：在模拟软件中指定相关系数

**步骤4：运行模拟**

模拟次数取决于：
- 概率变量数量越多 → 需要越多模拟
- 分布越多样 → 需要越多模拟
- 结果范围越广 → 需要越多模拟

现代软件可以轻松运行数万次模拟，**宁多勿少**。

---

### Illustration 33.4：Exxon Mobil 蒙特卡洛模拟

让我们用模拟来估值 Exxon Mobil（2009年3月）。

**第22章的 DCF 估值回顾**：

我们发现 Exxon 的营业收入与油价高度相关：

$$
\text{营业收入} = -6,395 + 911.32 \times \text{平均油价} \quad (R^2 = 90.2\%)
$$

油价每上涨 $10，Exxon 营业收入增加约 $91 亿！

**基准估值假设**（油价 $45/桶）：

| 参数 | 值 |
|------|-----|
| 正常化营业收入 | $346.14 亿 |
| 资本成本 | 8.18% |
| 永续增长率 | 2% |
| 资本回报率 | 21% |
| 股权价值/股 | $69.43（市价 $64.83） |

问题是：**油价 $45 是"正常"水平吗？**

**模拟设置**：

**步骤1：油价概率分布**

使用30年历史油价（通胀调整后）构建分布：

- 分布类型：对数正态
- 范围：$8 - $120+/桶
- 均值：$45（当前价格）

**步骤2：链接营业收入与油价**

$$
\text{营业收入} = -6,395 + 911.32 \times \text{油价}
$$

**步骤3：计算价值**

营业收入变化通过两个渠道影响价值：
1. **直接效应**：现金流变化
2. **间接效应**：资本回报率变化 → 再投资率变化

**步骤4：运行10,000次模拟**

```
模拟结果：
- 期望值/股：$69.59
- 最小值：$2.25
- 最大值：$324.42
- 标准差：$32.17
- 低于市价 $64.83 的概率：>50%
```

**关键洞察**：

期望值（$69.59）略高于市价（$64.83），但**有超过50%的概率价值低于市价**。

这提供了比点估计更丰富的信息：
- 如果你相信油价会上涨 → 股票被低估
- 如果你相信油价会下跌 → 股票可能被高估
- **不确定性本身**就是重要信息

::: {.callout-tip}
## 安全边际与模拟

价值投资者常用**安全边际（Margin of Safety）**：只有当市价低于估值的X%（如20%）时才买入。

模拟可以帮助设定安全边际。如果期望值是 $69.59，20%的安全边际意味着只有当股价低于 $55.67 时才买入。

更进一步：可以根据模拟分布的**百分位数**来设定安全边际——例如，只有当市价低于第30百分位价值时才买入。
:::

---

### 带约束的模拟

模拟的第二个用途是当存在**约束条件**，违反约束会带来巨大成本：

**监管资本约束**（银行、保险公司）：

- 监管要求账面股权/资产 ≥ 最低比率
- 违反约束 → 可能被接管
- 模拟可以评估违反约束的概率及其后果

**负账面股权**：

- 美国：负账面股权公司可能面临贷款违约条款触发
- 欧洲部分国家：负账面股权公司必须增发股权
- 亚洲部分国家：负账面股权公司禁止分红

**债务约束**：

- DCF 假设公司持续经营
- 但如果无法偿还债务，间接破产成本可能很大：
  - 客户流失
  - 供应商收紧信用
  - 员工流失
- 模拟可以显式建模困境对现金流和折现率的影响

---

### 模拟的价值与局限

**价值**：

1. **更好的输入估计**：迫使你认真思考每个变量的分布，而非随意给出点估计
2. **提供分布而非点估计**：期望值 + 标准差 + 分位数 = 对不确定性的完整理解
3. **风险可视化**：分布图直观展示了价值的不确定性

**注意**：我们**不**声称：
- 模拟比传统方法给出更好的期望值（应该接近）
- 模拟一定导致更好的决策（取决于如何使用）

**局限**：

| 问题 | 说明 |
|------|------|
| **垃圾进，垃圾出** | 分布必须基于分析和数据，而非猜测 |
| **真实数据不符合分布** | 很少有输入完美符合理论分布 |
| **分布不稳定** | 均值、方差、甚至分布形状可能随时间变化 |
| **相关性变化** | 变量间的相关性可能不稳定 |

### 模拟与风险调整价值

再次强调：**模拟不是风险调整！**

模拟产生的是期望现金流，不是风险调整现金流。除非风险完全是资产特定的、可分散的，否则应该用风险调整利率折现。

**避免双重计数**：

| 资产 | 风险调整折现率 | 模拟期望值 | 模拟标准差 |
|------|--------------|----------|----------|
| A | 12% | $100 | 15% |
| B | 15% | $100 | 21% |

B 的折现率更高是因为它更风险。如果再因为模拟标准差高而拒绝 B，就是**双重计数风险**。

正确做法：
- 要么用风险调整折现率 + 不考虑模拟波动性
- 要么用无风险利率 + 用模拟波动性作为风险度量

但后者有一个问题：它假设**所有风险**都重要，而非只有**不可分散风险**。对于分散化的投资者，高模拟波动性可能无关紧要。

---

## 三种方法的比较与选择

### 方法选择矩阵

| 风险特征 | 离散/连续 | 相关/独立 | 顺序/同时 | 推荐方法 |
|----------|-----------|-----------|-----------|----------|
| FDA 审批 | 离散 | 独立 | 顺序 | **决策树** |
| 监管变化 + 经济周期 | 离散 | 相关 | 同时 | **情景分析** |
| 油价、利率 | 连续 | 可能相关 | 都可以 | **模拟** |

**数据质量也很重要**：

- **模拟**：需要大量历史/横截面数据来估计分布
- **决策树**：需要能估计各阶段概率（可以用历史频率或专家判断）
- **情景分析**：数据最少的情况下仍可使用（但更主观）

### 补充 vs 替代风险调整估值

| 方法 | 补充 | 替代 |
|------|------|------|
| **情景分析** | ✓ 总是补充（不覆盖全部可能性） | ✗ 不能替代 |
| **决策树** | ✓ 可以补充 | ✓ 可以替代（用无风险利率 + 波动性度量） |
| **模拟** | ✓ 可以补充 | ✓ 可以替代（用无风险利率 + 波动性度量） |

**作为补充使用时的注意事项**：

1. 使用**风险调整折现率**
2. 不同结果可以用**不同折现率**（更好的结果可能风险更低）
3. **不要双重计数**：不能因为波动性高而拒绝已经用高折现率折现的投资

**作为替代使用时的注意事项**：

1. 使用**无风险利率**折现
2. 用波动性（标准差、价值范围）作为风险度量
3. 隐含假设：**所有风险都重要**（忽略可分散/不可分散的区分）

这种做法对于**单一资产投资者**合理，但对于**分散化投资组合**可能误导——高波动性资产可能与组合其他资产不相关，因此边际风险很低。

---

## 实践中的概率方法

`★ Insight ─────────────────────────────────────`

**Damodaran 的实践建议**：

1. **不要因为输出好看就相信模拟**——分布的质量取决于输入的质量
2. **概率方法不是魔法**——它们不能消除不确定性，只能帮助你**理解**不确定性
3. **最大的价值是迫使你思考**——思考哪些因素重要、它们如何相互影响、你在不同情景下会怎么做
4. **注意双重计数**——这是最常见的错误

`─────────────────────────────────────────────────`

随着数据可用性和计算能力的提升，概率方法变得越来越常见。现在经常可以看到资本预算分析附带20-30个情景，或者股票估值附带蒙特卡洛模拟。

但这种普及也带来了风险：**复杂的输出可能掩盖简单的错误**。

一个基于随机假设的模拟可以产生漂亮的图表和精确到小数点的"期望值"——但那只是**精确的垃圾**。

---

## 总结

::: {.callout-important}
## 核心要点

- **情景分析**：在几个关键情景下估值，揭示价值范围和敏感性。最适合离散、相关、同时发生的风险。

- **决策树**：将风险分解为阶段，追踪最优决策路径。最适合离散、独立、顺序发生的风险。输出包括期望值和最优决策规则。

- **蒙特卡洛模拟**：为输入定义概率分布，运行数千次估值。最适合连续风险。输出包括期望值和价值分布。

- **风险双重计数**是最大陷阱：
  - 不要用风险调整折现率 + 又因为波动性高而惩罚投资
  - 不要在折现率中已经内嵌了失败概率 + 又在决策树中显式计入失败

- **概率方法是补充而非替代**：它们帮助你理解风险的本质和价值的分布，但不能消除不确定性本身。

| 方法 | 适用风险 | 关键输出 | 数据要求 |
|------|----------|----------|----------|
| 情景分析 | 离散、相关、同时 | 情景价值、范围 | 最低 |
| 决策树 | 离散、独立、顺序 | 期望值、最优决策 | 中等 |
| 模拟 | 连续 | 期望值、完整分布 | 最高 |
:::

本章我们回答了开头的问题：**如何在点估计之外理解价值的不确定性？**

三种概率方法提供了不同的视角：
- 情景分析告诉你"如果发生X，价值会是多少"
- 决策树告诉你"每个阶段应该怎么做，最终期望值是多少"
- 模拟告诉你"价值的完整分布是什么样的"

但记住：**方法的复杂性不能替代输入的质量**。一个简单但基于深思熟虑假设的 DCF，往往比一个复杂但基于随意假设的模拟更有价值。

---

## 思考题

1. **情景分析的局限**：为什么最佳/最差情景分析通常"信息量有限"？在什么情况下它仍然有用？

2. **决策树中的沉没成本**：在药品开发决策树中，为什么即使 II 型糖尿病药物的整体 NPV 为负，公司仍应在 Phase 3 成功后继续开发？这与沉没成本谬误有什么关系？

3. **风险双重计数**：一位分析师用10%的折现率对某股票进行蒙特卡洛模拟，得到期望值 $50（市价 $45）和标准差 $15。他拒绝推荐该股票，理由是"波动性太高"。这个推理有什么问题？

4. **模拟的分布选择**：你需要模拟一家零售公司的收入增长率。历史数据显示增长率在 -15% 到 +25% 之间，均值 5%，略有右偏。你会选择什么分布？为什么？

5. **方法选择**：假设你要估值一家新兴市场的矿业公司，面临以下风险：(a) 大宗商品价格波动（连续），(b) 政府可能征收暴利税（离散，取决于价格），(c) 环境法规变化（离散，与税收相关）。你会用什么方法？如何构建分析？

6. **跨章节联系**：本章的概率方法与第28-30章的实物期权方法有什么关系？决策树中的"决策节点"与实物期权中的"灵活性价值"有什么联系？

---

*本章基于 Damodaran《Investment Valuation》第33章"Probabilistic Approaches in Valuation: Scenario Analysis, Decision Trees, and Simulations"撰写。*
